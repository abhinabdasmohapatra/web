var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.PowerPoint=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}({16:function(e,t,i){"use strict";i.r(t),i.d(t,"DocRebootSupportMode",(function(){return un})),i.d(t,"CommandIds",(function(){return te})),i.d(t,"EventIds",(function(){return oe})),i.d(t,"createCancellationToken",(function(){return nt})),i.d(t,"Application",(function(){return vn})),i.d(t,"createApplication",(function(){return wn}));var n=[[/!/g,"%21"],[/'/g,"%27"],[/\(/g,"%28"],[/\)/g,"%29"],[/\*/g,"%2A"]],o=["eurppc"];function r(e){return 8===e.toLowerCase().indexOf("ffc")}function s(e){return 8===e.toLowerCase().indexOf("ppc")}function a(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function c(e,t){if(!t||-1===o.indexOf(t.toLowerCase()))return e;var i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?"".concat(i[1]).concat(t,"-").concat(i[3]):e}function d(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function u(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function l(e){return e+"RemoteUls.ashx"}function f(e,t,i){i&&(e[t.toLowerCase()]=i)}function p(e,t){e[t.toLowerCase()]=""}function h(e,t){var i=e.toLowerCase(),n=t.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function v(e,t,i,n){if(!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(n){var d=c.index+1,u=o.indexOf("&",d);o=o.substring(0,d)+a+i+(-1===u?"":o.substring(u))}return o}return o.concat(s,a,i)}function w(e,t){if(!e)return e;var i=e,n=i.indexOf("?"),o=t.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return e}function m(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function g(e,t,i){var n=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(n);return!(!o||i&&o[1]!==i)}function S(e,t){var i=h(e,t);return i?decodeURI(i):i}function I(e){return h(window.location.href,e)}function b(e){var t=encodeURIComponent(e);return n.forEach((function(e){t=t.replace(e[0],e[1])})),t}function _(e){var t=(e+"===").substring(0,e.length+(4-e.length%4)%4);return t=(t=t.replace(/-/g,"+")).replace(/_/g,"/"),atob(t)}function T(e){var t=document.createElement("a");t.href=e;var i=t.port||80,n=window.location.port||80;return t.hostname===window.location.hostname&&i===n}function C(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function y(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return E&&(!t||t(e))},preconnect:function(t){return function(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}(e?m(t):t)}}}var P,A,U,E=!0;function O(e,t,i){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(P||(P={})),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=220]="msoulscat_MSOSP_AddInCommands",e[e.P=225]="msoulscat_MSOSP_OTelJS",e[e.A=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.U=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.O=301]="msoulscat_Wac_WordViewer",e[e.F=306]="msoulscat_Wac_BrowserGeneral",e[e.k=320]="msoulscat_Wac_TaskPane",e[e.N=339]="msoulscat_Wac_OneNoteGeneral",e[e.R=340]="msoulscat_Wac_Ribbon",e[e.B=356]="msoulscat_Wac_WacFeedback",e[e.H=379]="msoulscat_Wac_WopiPendingApplication",e[e.J=383]="msoulscat_Wac_Telemetry",e[e.j=391]="msoulscat_Wac_WacCatchUpActivities",e[e.q=394]="msoulscat_Wac_Dictation",e[e.K=395]="msoulscat_Wac_OneNoteSync",e[e.Z=700]="msoulscat_Wac_VisioApp",e[e.$=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.X=800]="msoulscat_Wac_PptAnimation",e[e.Y=833]="msoulscat_Wac_PptLive",e[e.ee=834]="msoulscat_Wac_PptMWeb",e[e.te=835]="msoulscat_Wac_PptGc2General",e[e.ie=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.ne=837]="msoulscat_Wac_PptGc2Operation",e[e.oe=844]="msoulscat_Wac_PptDataSync",e[e.re=848]="msoulscat_Wac_PptFluidRuntime",e[e.se=815]="msoulscat_Wac_PptShape",e[e.ae=817]="msoulscat_Wac_PptSession",e[e.ce=830]="msoulscat_Wac_PptSlideshow",e[e.de=822]="msoulscat_Wac_PptView",e[e.ue=846]="msoulscat_Wac_PptVideos",e[e.le=1303]="msoulscat_Uci_Insights",e[e.fe=2300]="msoulscat_Wac_VersionHistory",e[e.pe=302]="msoulscat_Wac_WordPresence",e[e.he=3e3]="msoulscat_Wac_OAuth",e[e.ve=3005]="msoulscat_Wac_WordVersionHistory",e[e.we=3006]="msoulscat_Wac_LivePersonaCard",e[e.me=3012]="msoulscat_Wac_CatchUpFlyout",e[e.ge=3016]="msoulscat_Wac_WordDesigner",e[e.Se=3021]="msoulscat_Wac_ModernFontPicker",e[e.Ie=3027]="msoulscat_Wac_UnifiedUiHost",e[e.be=3033]="msoulscat_Wac_EquationTools",e[e._e=1401]="msoulscat_Osf_Latency",e[e.Te=1402]="msoulscat_Osf_Notification",e[e.Ce=1403]="msoulscat_Osf_Runtime",e[e.ye=3041]="msoulscat_Wac_AiMaker",e[e.Pe=3043]="msoulscat_Wac_AiRewrite",e[e.Ae=3044]="msoulscat_Wac_AiInsert",e[e.Ue=3047]="msoulscat_Wac_AiSummarize",e[e.Ee=3048]="msoulscat_Wac_CopilotCompose",e[e.Oe=3049]="msoulscat_Wac_Skittles"}(A||(A={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(U||(U={}));var F,k,N={BUILD_NUMBER:"###VERSION###"};function R(){try{return"20240421.7"}catch(e){return N.BUILD_NUMBER}}function W(e,t,i){!function(e,t,i,n){void 0===n&&(n=!0);var o={type:t.toString(),payloadJson:JSON.stringify(i)};O(JSON.stringify(o),e,n)}(e,F.JSAPI_STATE,{application:t,build:R(),state:i})}function M(){return window.performance.now()}function D(){return Math.round(window.performance.now()+window.performance.timeOrigin)}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(F||(F={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(k||(k={}));var x,B,H=function(){function e(e){var t=this;this.Fe=3e4,this.ke=30,this.Ne=0,this.Re=[],this.We=D(),this.Me=[],this.De="",this.xe=0,this.flushOnClose=function(){t.Be(!1,!1)},this.flush=function(){t.He()},this.flushAndSetNewEndpoint=function(e,i){var n,o=t.Le(e);o.localeCompare(null!==(n=t.Ve)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(t.Me.push((function(){t.Ve=o,i&&i()})),t.Be(!0,!0))},this.Le=function(e){return e+"?usid="+t.De+"&officeserverversion="+R()},this.He=function(){window.setTimeout((function(){return t.Be(!0,!0)}),0)},this.Be=function(e,i){var n,o,r,s,a,c,d,u=M();window.clearTimeout(t.Je),t.Ve&&(t.Re.length>0&&(t.Ne+=1,O((n=t.Re.splice(0,e?t.ke:t.Re.length),o=t.De,r=t.Ne,s=t.We,a=[],c=n.map((function(e){return function(e,t,i){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=i.findIndex((function(t){return t===e.correlationId}));o<0&&(o=i.push(e.correlationId)-1),n.I=o}var r=1e3*e.type+e.level;return n.D=r,n}(e,s,a)})),d=function(e,t,i,n,o){var r={};return r.T=e,r.L=t,r.S=i,r.I=n,o&&o.length>0&&(r.W=o),r.V=1,r}(s,c,o,r,a),JSON.stringify(d)),t.Ve,i),t.We=D()),0===t.Re.length&&t.Me.length>0&&(t.Me.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.Me=[]),e&&(t.Je=window.setTimeout((function(){t.He()}),t.Re.length>t.ke||t.Me.length>0?1e3:t.Fe)),t.xe+=M()-u)},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.xe},e.prototype.addLoggingTime=function(e){this.xe+=e},e.prototype.configure=function(e){var t=M();if(e.uploadCadenceInMs&&(this.Fe=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.ke=e.uploadTriggerSize),e.sessionId&&(this.De=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.Ve)throw new Error("Remote ULS endpoint is already set");this.Ve=this.Le(e.remoteUlsEndpoint),this.We=D(),this.He()}this.xe+=M()-t},e.prototype.handleTrace=function(e){var t=M();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Re.push(e),(this.Re.length>this.ke||e.level===U.Error)&&this.He(),this.xe+=M()-t},e.prototype.getUserSessionId=function(){return this.De},e}(),L=[];function V(e){var t=new H(e);function i(e,i,n,o){var r=M();if(!function(e){return 1===L[e]}(e)){var s={timestamp:D(),category:i,tag:e,level:n,type:k.Trace,message:o,correlationId:""};t.addLoggingTime(M()-r),t.handleTrace(s)}}return{ULS:{Ge:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,n,o){n&&i(e,t,U.Error,o)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.je.getValue(B.ze,""),n=e.je.getValue(B.qe,""),x&&n===x||(L=[],x=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&(L[t]=1)}))),t.configure({uploadCadenceInMs:e.je.getValue(B.Ke,6e4)});var o=e.je.getValue(B.Ze,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,i){t.flushAndSetNewEndpoint(e,i)}}}!function(e){e.$e="BootstrapperMaxUlsHeartbeatTime",e.Xe="BootstrapperNoCompleteWarning1Time",e.Qe="BootstrapperNoCompleteWarning2Time",e.qe="RemoteUlsETag",e.ze="RemoteUlsSuppressions",e.Ye="BootstrapperSettingsFetchPeriod",e.et="timestamp",e.tt="BootstrapperUlsHeartbeatIntervalMs",e.it="BootstrapperUlsHeartBeatIsEnabled",e.Ke="BootstrapperUlsUploadCadenceMs",e.nt="WordConsumptionViewToEditRedirectIsEnabled",e.ot="RequestedCallThrottlingDefaultToViewMinimumValue",e.Ze="BulsEndpointUrl",e.rt="EnableCommonHostDiagnosticsParams",e.st="EnableICNForWord",e.ct="EnableModernEmbedViewForPowerPoint",e.dt="EnableModernEmbedViewInOneUpForPowerPoint",e.ut="EnableModernEmbedViewForPowerPointGlobalAppUrl",e.lt="EnableModernReadingViewForPowerPoint",e.ft="EnableDefaultToModernForPowerPoint",e.pt="ShouldLogJsApiKpisForWord",e.ht="WordSwitchToViewInTeamsJsapiV1Enabled",e.vt="EnableWordSessionRefreshTelemetry",e.wt="PowerPointUseEssDCHint",e.gt="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",e.St="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",e.It="ModernEmbedViewForPowerPointEnabledPercentage",e.bt="PowerPointESSCookieLookbackThresholdHour",e._t="PowerPointSetESSCookieLookbackExpEnabled"}(B||(B={}));var J,G=function(e,t){return(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},j=function(){return(j=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function z(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function q(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function K(e,t,i){if(i||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function Z(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function $(e,t){return void 0===t?null:t}function X(e){if(!e)return"";var t=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,K(K([],t,!0),i,!0))}function Q(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(t)try{return t(e)}catch(e){i&&i.ULS.Ge(594883024,A.H,U.Error,"IsFeatureEnabled callback error: "+X(e))}}(i,e,t)}}}function Y(e,t){var i={};if(Object.keys(J).forEach((function(t){var n=e.isFeatureEnabled(J[t]);void 0!==n&&(i[J[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[J.Tt]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}Object.create,Object.create,function(e){e.Tt="EnterpriseTemplates",e.Ct="ExcelAdaptiveLayoutDownload",e.yt="ExcelLandingPageOfflineTelemetry",e.Pt="ExcelLandingPageObserverRetry",e.At="H2StaticContent",e.Ut="HashedUrl",e.Et="ODCShareLinkPreload",e.Ot="OfficeComExcelJsApiV2",e.Ft="OfficeComPptJsApiV2",e.kt="OfficeComUiHost",e.Nt="OfficeComWordJsApiV2",e.Rt="OfficeHwaUiHost",e.Wt="OfficeUnifiedUiHostTeams",e.Mt="WordViewToUnifiedRead",e.Dt="PowerPointEarlySessionStart"}(J||(J={}));var ee,te,ie,ne,oe,re,se=function(){function e(){this.xt=[]}return e.prototype.add=function(e){e&&this.xt.push(e)},e.prototype.remove=function(e){if(e){var t=this.xt.indexOf(e);t>-1&&this.xt.splice(t,1)}},e.prototype.removeAll=function(){this.xt=[]},e.prototype.dispatch=function(e,t){this.xt.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),ae=function(){function e(e,t){var i=this;this.Bt=0,this.Ht=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(i.Lt);if(!e)return;var t=JSON.parse(e);i.Vt(t)}catch(e){i.Jt.ULS.Ge(592836768,A.H,U.Warning,"Failed to get settings from localStorage: "+X(e))}},this.Vt=function(e){return!!i.Gt(e)&&(i.jt=e,i.zt.dispatch({je:i},(function(e){i.Jt.ULS.Ge(592836769,A.H,U.Error,"Settings listener error: "+X(e))})),!0)},this.Gt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(B.et)&&!isNaN(e.timestamp))return!0;i.Jt.ULS.Ge(592836770,A.H,U.Error,"Received invalid settings")}return!1},this.qt=function(){if(i.Kt){var e=new XMLHttpRequest;e.open("GET",i.Kt),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i.Zt(e.response),i.Bt=0):(i.Jt.ULS.Ge(592836771,A.H,U.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(i.Bt)),i.Bt+=1),!(i.Bt>7)){var t=i.getValue(B.Ye,3e5);i.Bt>3&&(t+=(i.Bt-3+1)*(t/2)),i.$t=window.setTimeout(i.qt,t)}}}},this.Zt=function(e){"requestIdleCallback"in window?(i.Xt&&self.cancelIdleCallback(i.Xt),i.Xt=window.requestIdleCallback((function(){return i.Qt(e)}),{timeout:1e4})):window.setTimeout((function(){return i.Qt(e)}),0)},this.Qt=function(e){if(i.Vt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(i.Lt,t)}catch(e){i.Jt.ULS.Ge(592836800,A.H,U.Warning,"Failed to set localStorage: "+X(e))}}},this.Yt=e,this.Lt="Prod"+e+"Settings",this.Jt=t,this.zt=new se,this.Ht()}return e.prototype.updateEnvironment=function(e){this.Lt=(r(e)?"FF":"Prod")+this.Yt+"Settings",this.Ht()},e.prototype.initializePeriodicFetch=function(e,t){this.Lt=(r(e)?"FF":"Prod")+this.Yt+"Settings",this.Ht(),this.Kt=e+"AppSettingsHandler.ashx?app="+this.Yt+"&usid="+t+"&build="+R(),this.$t||(this.$t=window.setTimeout(this.qt,3e4))},e.prototype.getValue=function(e,t){if(this.jt||this.Ht(),!this.jt||!this.jt.hasOwnProperty(e))return t;var i=this.jt[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.zt.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.zt.remove(e)},e.prototype.dispose=function(){this.$t&&window.clearTimeout(this.$t),this.Xt&&self.cancelIdleCallback(this.Xt),this.$t=void 0,this.Xt=void 0,this.jt=void 0,this.zt.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete",e.setWacFlightValue="setWacFlightValue"}(ee||(ee={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(te||(te={})),function(e){e.ei="App_AccessibilityLoopComplete",e.ti="Wac_ActionComplete",e.ii="WacInitialize_Ready",e.ni="Wac_AppFailed",e.oi="Wac_AppBootState",e.ri="Wac_AppCompleted",e.si="BrowserEvent",e.ai="UI_Close",e.ci="App_CloseTab",e.di="UI_Conversation",e.li="UI_CopyAndEdit",e.fi="App_CreateNewDocument",e.pi="Wac_AppDataSavedStatus",e.hi="UI_Download",e.vi="UI_Edit",e.wi="Error",e.mi="UI_FileEmbed",e.gi="UI_FileProperties",e.Si="File_Rename",e.Ii="File_RenameFailed",e.bi="UI_FileVersions",e._i="StateChanged",e.Ti="App_IsFrameTrusted",e.Ci="GetAccessToken",e.yi="App_GetAuthToken",e.Pi="App_GetCustomAuthConfig",e.Ai="App_GetHostKeyValue",e.Ui="App_WopiInfoFromUrl",e.Ei="App_DavUrlFromIds",e.Oi="App_LoadingStatus",e.Fi="App_SwitchMode",e.ki="App_MoveToFolder",e.Ni="UI_OpenInMobileApp",e.Ri="UI_OpenInBrowser",e.Wi="UI_OpenInClient",e.Mi="PageChanged",e.Di="App_PushCommentContext",e.xi="App_PushState",e.Bi="App_DocReboot",e.Hi="UI_RedeemForCommenting",e.Li="App_RefreshSessionInfo",e.Vi="UI_ReplyWithChanges",e.Ji="UI_ReportAbuse",e.Gi="App_FilePicker",e.ji="UI_SaveStatus",e.zi="WopiSession_Complete_Ack",e.qi="SetOverlayContent",e.Ki="UI_Sharing",e.Zi="UI_ShareForm",e.$i="UI_SignIn",e.Xi="App_StoreHostKeyValue",e.Qi="App_Unloaded",e.Yi="App_UlsLog",e.en="Wac_UnloadingApp",e.tn="App_UpdateBootComplete",e.in="PageCount",e.nn="UI_CheckUserAccessAndGrantPermissions",e.on="User_Activity",e.rn="Edit_Notification",e.sn="UI_Workflow",e.an="ZoomChanged",e.cn="CAAEMessage",e.dn="Excel_HostFrameCacheSave",e.un="Excel_HostFrameCacheEvict",e.ln="Excel_RegenerateFileBundle",e.fn="App_SwitchToWacFrame",e.pn="App_SaveSSRData",e.hn="App_PurgeDataInHostCache",e.vn="App_SaveHostRenderingV2Data",e.wn="App_SaveHostUtilsData",e.mn="AcquireOAuthTokenTeams",e.gn="App_SwitchNotebook",e.Sn="FailedBoot_CheckFileInfo",e.In="GetTeamsUsers",e.bn="SendTeamsUserMention",e._n="NavigateBackToHost",e.Tn="App_GetClientUrlComplete",e.Cn="App_GetWebUrlComplete",e.yn="App_CopyLinkComplete",e.Pn="App_SendConversationId",e.An="CloseTeamsConversation",e.Un="PageLoaded",e.En="Visio_BRS",e.On="Visio_SendLicenseInfo",e.Fn="Visio_Consumption_CLTComplete",e.kn="Visio_SwitchMode_FromViewFrame",e.Nn="Visio_ModeSwitch_ToHost_Ack",e.Rn="Visio_UpdateEditUrl",e.Wn="Visio_PageViewLoaded",e.Mn="Visio_ActiveAppFrameLoadFailed",e.Dn="Visio_DisposeBkgFrame",e.xn="Visio_ReadyToReceiveDocData",e.Bn="Visio_DocReboot_HostNav",e.Hn="Visio_SwitchToVisioFrame",e.Ln="WacAppPerfMetric",e.Vn="App_ModifyURLState",e.Jn="App_WacTokenAck",e.Gn="App_InitEnd",e.jn="App_SplashScreenShown",e.zn="App_SetWacFlightValue"}(ie||(ie={})),function(e){e.qn="Ack",e.Kn="WacInitialize_Ready_Ack",e.Zn="Wac_BeforeUnloadApp",e.$n="Blur_Focus",e.Xn="Wac_AppFailed_Ack",e.Qn="Wac_AppCompleted_Ack",e.Yn="WopiStartSession_Complete",e.eo="WopiPendingSession_Complete",e.to="Host_AccessibilityLoopComplete",e.Ti="Host_IsFrameTrusted",e.io="Grab_Focus",e.no="HostCacheDiagnostic",e.oo="Host_KeyValue",e.ro="JsApiDiagnostics",e.ki="Host_MoveToFolder",e.so="PageChanged_Ack",e.ao="App_PopState",e.co="Host_SendChannelId",e.do="Host_SendConversationId",e.uo="GetTeamsUsers_Reply",e.lo="SendTeamsUserMention_Reply",e.fo="Host_BackButtonPressed",e.po="Host_GetClientUrl",e.ho="Host_GetWebUrl",e.vo="OwlFrameDiagnostics",e.wo="File_Rename",e.Gi="Host_FilePicker",e.mo="PostAccessToken",e.So="Host_SetAuthToken",e.Io="Host_SetCustomAuthConfig",e.bo="App_PushCommentContext",e._o="CanEmbed",e.To="Host_RefreshSessionInfo",e.Co="CheckUserAccessAndGrantPermissions_Result",e.yo="Host_WopiInfoFromUrl",e.Po="Host_DavUrlFromIds",e.Ao="SetCurrentPage",e.Uo="SetZoomLevel",e.Eo="WopiPendingSession_Fail",e.Oo="SetOverlayContent",e.Fo="WopiPendingApplicationComplete_Received",e.ko="Host_SwitchMode",e.No="Host_Unload",e.Ro="PageCount_Ack",e.Wo="ZoomChanged_Ack",e.Mo="Host_ShareUI",e.Do="Host_Telemetry",e.xo="Visio_ConsumptionCLTComplete_Ack",e.Bo="Visio_SwitchMode_FromHF_Ack",e.Ho="Visio_SwitchMode_FromHostFrame",e.Lo="Visio_FallbackToLegacySwitch",e.Vo="Visio_DocumentData",e.Jo="Host_PostWacToken"}(ne||(ne={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.InitEnd="InitEnd",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(oe||(oe={}));var ce,de=((re={})[te.boot]={Go:ee.boot},re[te.createNew]={Go:ee.createNew},re[te.dispose]={Go:ee.dispose},re[te.postWacToken]={Go:ee.postWacToken},re[te.rename]={Go:ee.rename},re[te.switchMode]={Go:ee.switchMode},re[ie.oi]={Go:ee.handleBootState},re[ie.ci]={Go:ee.closeTab},re[ie.Ti]={Go:ee.frameTrust},re[ie.yi]={Go:ee.getAuthToken},re[ie.Ai]={Go:ee.getHostKeyValue},re[ie.Bi]={Go:ee.appReboot},re[ie.zn]={Go:ee.setWacFlightValue},re[ie.qi]={Go:ee.setOverlayContent},re[ie.Xi]={Go:ee.storeHostKeyValue},re[ie.tn]={Go:ee.updateBootComplete},re[te.blurFocus]={jo:ne.$n},re[te.continueAccessibilityLoop]={jo:ne.to},re[te.grabFocus]={jo:ne.io},re[te.moveToFolder]={jo:ne.ki},re[te.popState]={jo:ne.ao},re[te.sendChannelId]={jo:ne.co},re[te.sendConvId]={jo:ne.do},re[te.teamsUsersReply]={jo:ne.uo},re[te.teamsUserMentionReply]={jo:ne.lo},re[te.backButtonPressed]={jo:ne.fo},re[te.getClientUrl]={jo:ne.po},re[te.getWebUrl]={jo:ne.ho},re[te.sendAccessToken]={jo:ne.mo},re[te.sendAuthToken]={jo:ne.So},re[te.sendHWRTelemetry]={jo:ne.Do},re[te.sendCustomAuthConfig]={jo:ne.Io},re[te.sendDavUrl]={jo:ne.Po},re[te.sendEmbeddedViewUrl]={jo:ne._o},re[te.sendFrameTrustResult]={jo:ne.Ti},re[te.sendSessionInfo]={jo:ne.To},re[te.sendUserAccessAndPermissions]={jo:ne.Co},re[te.sendWopiInfo]={jo:ne.yo},re[te.signalShared]={jo:ne.Mo},re[te.sendOwlFrameDiagnostics]={jo:ne.vo},re[te.completeSharedFilePicker]={jo:ne.Gi},re[ie.ei]={zo:oe.AccessibilityLoopCompleted},re[ie.ti]={zo:oe.ActionCompleted},re[ie.si]={zo:oe.BrowserEvent},re[ie.cn]={zo:oe.CAAEMessage},re[ie.ai]={zo:oe.Close},re[ie.di]={zo:oe.Conversation},re[ie.li]={zo:oe.CopyAndEdit},re[ie.fi]={zo:oe.CreateNewDocument},re[ie.hi]={zo:oe.Download},re[ie.vi]={zo:oe.Edit},re[ie.wi]={zo:oe.Error},re[ie.mi]={zo:oe.FileEmbed},re[ie.gi]={zo:oe.FileProperties},re[ie.Si]={zo:oe.FileRenamed},re[ie.bi]={zo:oe.FileVersions},re[ie.Ci]={zo:oe.GetAccessToken},re[ie.Ei]={zo:oe.GetDavUrlFromIds},re[ie.Pi]={zo:oe.GetCustomAuthConfig},re[ie.Ui]={zo:oe.GetWopiInfoFromUrl},re[ie._i]={zo:oe.FrameStateChanged},re[ie.Fi]={zo:oe.ModeSwitched},re[ie.ki]={zo:oe.MoveToFolder},re[ie.Ni]={zo:oe.OpenInMobileApp},re[ie.Ri]={zo:oe.OpenInBrowser},re[ie.Wi]={zo:oe.OpenInClient},re[ie.Mi]={zo:oe.PageChanged},re[ie.xi]={zo:oe.PushState},re[ie.Hi]={zo:oe.RedeemForCommenting},re[ie.Li]={zo:oe.RefreshSessionInfo},re[ie.Vi]={zo:oe.ReplyWithChanges},re[ie.Gi]={zo:oe.SharedFilePicker},re[ie.Ji]={zo:oe.ReportAbuse},re[ie.ji]={zo:oe.SaveStatus},re[ie.Ki]={zo:oe.Share},re[ie.Zi]={zo:oe.ShareForm},re[ie.$i]={zo:oe.SignIn},re[ie.nn]={zo:oe.UserAccessAndPermissions},re[ie.on]={zo:oe.UserActivity},re[ie.rn]={zo:oe.UserEditActivity},re[ie.sn]={zo:oe.Workflow},re[ie.an]={zo:oe.ZoomChanged},re[ie.mn]={zo:oe.AcquireOAuthTokenTeams},re[ie.Oi]={zo:oe.LoadingStatus},re[ie.gn]={zo:oe.SwitchNotebook},re[ie.Sn]={zo:oe.FailedBootCheckFileInfo},re[ie.In]={zo:oe.GetTeamsUsers},re[ie.bn]={zo:oe.SendTeamsUserMention},re[ie._n]={zo:oe.NavigateBackToHost},re[ie.Tn]={zo:oe.GetClientUrlComplete},re[ie.Cn]={zo:oe.GetWebUrlComplete},re[ie.yn]={zo:oe.CopyLinkComplete},re[ie.Pn]={zo:oe.SendConversationId},re[ie.An]={zo:oe.CloseTeamsConversation},re[ie.Un]={zo:oe.PageLoaded},re[ie.Gn]={zo:oe.InitEnd},re[ie.jn]={zo:oe.SplashScreenShown},re);function ue(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(X(e)))}}t.perfNow=!0;for(var n=0;n<e.length;n+=1){try{var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}catch(e){t.exceptions.push("Math.random: ".concat(X(e)))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}function le(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,fe)}function fe(){var e=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):Math.floor(16*Math.random()).toString(16)}!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(ce||(ce={}));var pe,he=window.navigator,ve=he?he.userAgent:void 0;function we(){if(ve){if(ve.indexOf("Firefox")>-1)return ce.Firefox;if(ve.indexOf("Opera")>-1||ve.indexOf("OPR")>-1)return ce.Opera;if(ve.indexOf("Trident")>-1)return ce.IE;if(ve.indexOf("Electron")>-1&&ve.indexOf("Teams")>-1)return ce.TeamsElectron;if(ve.indexOf("Edg")>-1)return ce.Edge;if(ve.indexOf("Chrome")>-1)return ce.Chrome;if(ve.indexOf("Safari")>-1)return ce.Safari}return ce.Unknown}function me(){try{return!!ve&&ve.indexOf("iPad")>=0||!!ve&&ve.indexOf("Macintosh")>=0&&Te()&&!Ie()||!!ve&&ve.indexOf("Android")>=0||Te()}catch(e){return!1}}function ge(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function Se(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function Ie(){return!!ve&&ve.indexOf("iPhone")>=0}function be(){return Ie()||/android.+mobile/i.test(he.userAgent)}function _e(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1}function Te(){return!!he&&he.maxTouchPoints>0}function Ce(e,t){t&&Object.keys(t).forEach((function(i){e[i]=t[i]}))}function ye(e,t){try{if(void 0===window.performance)return void t.ULS.Ge(595948609,A.H,U.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.Ge(595948610,A.H,U.Info,"No resources under performance");for(var n=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),o=i.length-1;o>=0;o-=1){var r=i[o],s=r.name.match(n);if(s){var a=JSON.stringify(r);return a=a.replace(new RegExp(r.name,"g"),s[0]),void t.ULS.Ge(595948616,A.H,U.Info,a)}}t.ULS.Ge(595948484,A.H,U.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.Ge(595948617,A.H,U.Info,"Could not trace the resource timing: ".concat(X(e)))}}function Pe(e){var t,i,n=j(j({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete n.siteId,delete n.webId,delete n.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var c=j({},e.rebootOverride);delete c.ackExpected,delete c["ui-language"],delete c.wdUserSession,delete c.rebootMode,delete c.documentUrl;var d=e.wopi;return{accessToken:d?{length:d.accessToken.length,expiry:d.expiry}:"N/A",wacToken:d&&d.wacToken?{length:d.wacToken.length}:void 0,bootParams:e.bootParams,build:R(),host:n,intent:e.intent,jsApiVersion:"v2",rebootOverride:c,region:a(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function Ae(){var e={perfNowSupported:!0,browser:ce[we()],touchMode:me(),highContrast:ge(),windows10x:Se()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function Ue(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.Ge(558155803,A.H,U.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.Ge(596444237,A.H,U.Info,JSON.stringify({session:Pe(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.Ge(558155804,A.H,U.Error,"Failed to log init info: ".concat(X(t)))}}function Ee(){try{return localStorage.setItem("Test","Test"),localStorage.removeItem("Test"),!0}catch(e){return!1}}function Oe(e,t){try{var i=parseInt(e,10);if(!i)return;if(i<=D()-6e4)t.ULS.Ge(558155805,A.H,U.Warning,"Bad userClickTime or host took 60+s to kick off the session from click");else if(Ee()){var n=i.toString(),o=localStorage.getItem("lastUserClickTime");if(o){var r=parseInt(o,10);r&&i<=r?t.ULS.Ge(558155806,A.H,U.Warning,"Bad userClickTime: less than or equal to lastUserClickTime, delta: "+(r-i)):localStorage.setItem("lastUserClickTime",n)}else localStorage.setItem("lastUserClickTime",n)}}catch(e){t.ULS.Ge(558155807,A.H,U.Error,"Error when tracking userClickTime: "+X(e))}}function Fe(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var i=window.performance.navigation;if(i&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount),!e.hostPageNavigationType)){var n="UNKNOWN";switch(i.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}e.hostPageNavigationType=n}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(pe||(pe={}));var ke=function(){function e(e,t){this.qo=function(){return Ne(e,"OnBeforeUnload",t)},this.Ko=function(){return Ne(e,"OnPageHide",t)},this.Zo=function(){return Ne(e,"VisibilityChange_"+document.visibilityState,t)},this.$o=function(){return Ne(e,"OnUnload",t)},window.addEventListener("beforeunload",this.qo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Ko,{capture:!0}),window.addEventListener("visibilitychange",this.Zo,{capture:!0}),window.addEventListener("unload",this.$o,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.qo,{capture:!0}),window.removeEventListener("pagehide",this.Ko,{capture:!0}),window.removeEventListener("visibilitychange",this.Zo,{capture:!0}),window.removeEventListener("unload",this.$o,{capture:!0})},e}();function Ne(e,t,i){e.ULS.Ge(595957843,A.H,U.Info,"Page lifecycle: ".concat(t," fired")+(i?", flushing logger":"")),i&&e.ULS.flush()}var Re=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000"],We=function(){function e(e){var t=this;this.Xo={},this.Qo=[],this.Yo=function(e){if(e&&e.origin)try{var i=e.data;if("string"==typeof i&&i.includes("AddinTrustedOrigin")){var n=JSON.parse(i),o=n.AddinTrustId;o&&"AddinTrustedOrigin"===n.MessageId&&(t.Jt.ULS.Ge(560754784,A.H,U.Info,"didReceiveMessage addinTrustId ".concat(o)),t.Xo[o]=e.origin,t.Qo.forEach((function(t){t(o,e.origin)})))}}catch(e){t.Jt.ULS.Ge(560754785,A.H,U.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.Jt=e,window.addEventListener("message",this.Yo)}return e.prototype.isResourceTrustedForMessage=function(e){return z(this,void 0,void 0,(function(){var t,i,n,o,r,s,a,c,d=this;return q(this,(function(u){switch(u.label){case 0:return e&&e.Resource?(t=e.Resource,i=e.AddinTrustId,(n=function(e){if(!e)return!1;for(var t=e.toLowerCase(),i=0,n=Re;i<n.length;i++){var o=n[i];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!i?[2,n]:this.Xo[i]?[2,Me(t,this.Xo[i])]:(r=new Promise((function(e){o=function(n,o){i===n&&e(Me(t,o))},d.Qo.push(o)})),s=-1,a=new Promise((function(e){s=window.setTimeout((function(){d.Jt.ULS.Ge(560754786,A.H,U.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(i)),e(!1)}),2e3)})),[4,Promise.race([r,a])])):[2,!1];case 1:return c=u.sent(),this.Qo=this.Qo.filter((function(e){return e!==o})),window.clearTimeout(s),[2,c]}}))}))},e.prototype.dispose=function(){this.Xo={},this.Qo=[],window.removeEventListener("message",this.Yo)},e}();function Me(e,t){try{if(!e||!t)return!1;for(var i=/[?&#%\\]/,n=0;n<e.length;n+=1){var o=e.charCodeAt(n);if(o<33||o>126)return!1;var r=e.charAt(n);if(i.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var De,xe=function(){function e(e,t,i,n,o,r,s){var a,c,d=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.er={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},n=d.er[t];if(n&&n.length>0)d.tr(t,i);else{var o=de[t];if(o){var r=o.Go,s=o.zo;r?(d.logger.ULS.Ge(574654543,A.H,U.Info,"Running flow: ".concat(r)),d.ir[r](t,i,d,d.nr[r]).catch((function(e){d.or(r,e)}))):s&&(s===oe.Share&&(i.sendTimeAsClickTime=e.SendTime),d.raiseEvent(s,i))}}},this.or=function(e,t){d.logger.ULS.Ge(596459925,A.H,U.Error,"".concat(e," flow error: ").concat(X(t))),d.remoteTelemetryUrl&&W(d.remoteTelemetryUrl,d.appInfo.name,"flowException")},this.tr=function(e,t){d.logger.ULS.Ge(574654544,A.H,U.Info,"Dispatching action: ".concat(e));for(var i=d.er[e].slice().reverse(),n=i.length-1;n>-1;n-=1)try{i[n](e,t)}catch(t){d.logger.ULS.Ge(596444186,A.H,U.Error,"".concat(e," action handler error: ").concat(X(t)))}return Promise.resolve({completion:"success"})},this.state=P.Unknown;var u=ue(),l=u[0],f=u[1];this.isLoggerFromOwl=!!i.logger,this.logger=null!==(c=i.logger)&&void 0!==c?c:V(),this.logger.ULS.Ge(593506837,A.H,U.Info,JSON.stringify(f)),this.sessionId=l,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=n,this.appInfo=t,this.session=o,this.featureManager=Q(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.je=new ae(t.name,this.logger),this.preloader=t.preloader,a=r(this.featureManager),this.ir=a[0],this.nr=a[1],this.rr=s,this.clientDiagnostics=Ae(),this.pageStateObserver=new ke(this.logger,!0),this.authTokenTrustValidator=new We(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.Ge(574654541,A.H,U.Info,"Raising event: ".concat(e));try{this.rr(e,t)}catch(e){this.logger.ULS.Ge(593506838,A.H,U.Error,"Event handler error: ".concat(X(e)))}},e.prototype.addActionHandler=function(e,t){this.er[e]||(this.er[e]=[]),this.er[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.er[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var n=this;if(this.state===P.Disposed&&this.backgroundSession)return this.logger.ULS.Ge(525203609,A.H,U.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,i);var o=[],r=this.er[e];if(r&&r.length>0)o.push(this.tr(e,t));else{var s=de[e];if(s){var a=s.Go,c=s.jo;if(a){this.logger.ULS.Ge(574654542,A.H,U.Info,"Running flow: ".concat(a));var d=this.ir[a](e,t,this,this.nr[a],i).catch((function(e){return n.or(a,e),{completion:"failure",errorSource:"jsapi",error:e}}));o.push(d)}else c&&(this.container&&this.container.postMessage(c,t),o.push(Promise.resolve({completion:"success"})))}else o.push(Promise.resolve({completion:"failure"})),this.logger.ULS.Ge(593500189,A.H,U.Warning,"Unhandled command: ".concat(e))}return Promise.race(o)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.je.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.er={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}(),Be=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i),this.sr=new xe(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.sr.state=P.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.sr.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.sr.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,i){return this.sr.run(e,t,i)},e.prototype.boot=function(e,t){return this.sr.run(te.boot,e,t)},e.prototype.dispose=function(e){return this.sr.run(te.dispose,void 0,e)},e}();function He(e){if(!e)return"";var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);return!n||n.length<2?"":n[1]}function Le(e,t,i,n,o){void 0===n&&(n=De.none);var r=e+"="+t,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var d=r+s+";SameSite="+De[n];return document.cookie=o?d+"; Secure":d,!(!document.cookie||-1===document.cookie.indexOf(r))||n===De.none&&Le(e,t,i,De.doNotSet,o)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(De||(De={}));var Ve,Je=function(){function e(e,t,i,n){var o,r,s=this;this.ar="",this.cr="",this.dr=!1,this.ur=!1,this.lr=!1,this.pr=!1,this.hr=function(e){var t,i=!1,n=!0,o="",r=!1;if(s.vr&&s.vr.contentWindow&&(i=!0,n=e.source===s.vr.contentWindow),e.origin&&!(r=(o=u(e.origin,2).toLowerCase())===s.cr)&&s.wr&&(o=u(e.origin).toLowerCase(),r=s.wr.includes(o)),!s.dr&&(!s.ur||r&&n)||s.Jt.ULS.Ge(593232850,A.H,U.Info,"Window: available["+i+"] valid["+n+"]; Origin: valid["+r+"] expected["+s.cr+"] actual["+o+"]"),r&&(!s.lr||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void s.Jt.ULS.Ge(593232851,A.H,U.Info,"Failed to parse event data: ".concat(X(e)))}var c=a.MessageId;if(c){if(s.Jt.ULS.Ge(593232854,A.H,U.Info,"Received message: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ie.ri&&c!==ie.Oi||s.setTargetOrigin(e.origin),a.Values&&a.Values.ackExpected&&s.postMessage(ne.qn,void 0,a.CorrelationId),s.pr&&c===ie.Ln)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);if(s.mr)try{s.mr(a)}catch(e){s.Jt.ULS.Ge(594556386,A.H,U.Error,"Message handler error: ".concat(X(e)))}else s.Jt.ULS.Ge(591933923,A.H,U.Error,"No message handler")}else(s.dr||s.ur)&&s.Jt.ULS.Ge(593232853,A.H,U.Info,"Missing message id")}},this.Jt=t,this.setTargetOrigin(e),this.wr=n,i&&this.setMessageHandler(i),this.pr=!!(null===(r=null===(o=window.location)||void 0===o?void 0:o.search)||void 0===r?void 0:r.match(/wdpa=1/gi))||"1"===He("EnableMetricLogging"),window.addEventListener("message",this.hr,!1)}return e.prototype.setTargetOrigin=function(e){var t=d(e).toLowerCase();this.ar&&this.ar!==t&&this.Jt.ULS.Ge(593232847,A.H,U.Warning,"Updating origin: [".concat(C(this.ar),"]->[").concat(C(t),"]")),this.ar=t,this.cr=u(t,2),this.dr=r(t),this.ur=s(t)},e.prototype.setTargetFrame=function(e,t){this.vr=e,this.lr=!!t},e.prototype.setMessageHandler=function(e){this.mr=e},e.prototype.removeMessageHandler=function(){this.mr=void 0},e.prototype.postMessage=function(e,t,i){if(this.vr&&this.vr.contentWindow){this.Jt.ULS.Ge(593232849,A.H,U.Info,"Sending message: "+e);var n={MessageId:e,SendTime:D(),CorrelationId:i,Values:t};this.vr.contentWindow.postMessage(JSON.stringify(n),this.ar)}else this.Jt.ULS.Ge(593232848,A.H,U.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.hr,!1),this.mr=void 0},e}();function Ge(e,t){we()===ce.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function je(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.Ge(591525084,A.H,U.Info,"Trust check error: ".concat(X(t))),!1}}function ze(e){return!(!e||!e.parentNode)&&(e.id?!!document.getElementById(e.id):void 0!==e.isConnected?e.isConnected:document.body.contains(e))}!function(e){e.gr="access_token",e.Sr="access_token_ttl",e.Ir="wac_token",e.br="bundleSrc",e._r="bundleStaleness",e.Tr="DocID",e.Cr="SiteID",e.yr="WebID",e.Pr="ETag",e.Ar="feature_status",e.Ur="fileExtension",e.Er="fileGetUrl",e.Or="customFontCatalogUrl",e.Fr="fileName",e.kr="fileSize",e.Nr="forceSLR",e.Rr="frameHeightPx",e.Wr="frameWidthtPx",e.Mr="highContrast",e.Dr="highDpi",e.xr="host_diagnostics",e.Br="hostName",e.Hr="huictrls",e.Lr="owner_id",e.Vr="sc",e.Jr="softBlockedBrowser",e.Gr="templateUrl",e.jr="touchMode",e.zr="user_id",e.qr="hfck",e.Kr="hfcv",e.Zr="timeZoneId",e.$r="darkCssMedia",e.Xr="caae",e.Qr="meetingId",e.Yr="meetingTitle",e.es="meetingType",e.ts="scheduledStartTime",e.ns="scheduledEndTime",e.os="isPresenter",e.rs="meetingOrganizerId",e.ss="meetingJoinUrl",e.as="isMeetingTeamsRoom",e.cs="jsapibuild",e.ds="owlver",e.us="owlro",e.ls="caaemode",e.fs="traceparent",e.ps="tracestate",e.hs="supports_zipit"}(Ve||(Ve={}));var qe=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.vs=e,this.ws=t,this.ms=t+"_Form",this.gs=je()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.vs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.ws},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.ms},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.gs},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,i,n){var o=this;this.Jt=i,this.Ss=new Je(e,i,this.mr,n.additionalReceivingDomainList);var r=n.useAdditionalDiv,s=n.permissionsPolicy;this.Is&&!r?(this.Is.setAttribute("allow",s),this.Jt.ULS.Ge(588793045,A.H,U.Info,"Wac frame reused")):(this.Is=function(e,t,i,n,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,d=c.createElement("iframe");if(d.id=t,d.name=t,d.src="",d.title="Office on the web Frame",d.marginWidth="0",d.marginHeight="0",d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.height="100%",d.style.width="100%",d.style.display="block",d.style.position="absolute",d.style.backgroundColor="transparent",d.style.border="none",d.frameBorder="0",d.setAttribute("allowfullscreen","true"),d.setAttribute("allowTransparency","true"),d.setAttribute("allow",i),Ge(d,s),n&&(e.style.minHeight=n,d.style.minHeight=n),o&&(e.style.minWidth=o,d.style.minWidth=o),a&&d.setAttribute("role","none"),r){var u=c.createElement("div");u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.backgroundColor="#393a3d",u.style.backfaceVisibility="hidden",n&&(u.style.minHeight=n),o&&(u.style.minWidth=o),u.appendChild(d),e.appendChild(u)}else e.appendChild(d);return d}(this.vs,this.ws,s,n.minHeight,n.minWidth,r,n.isInvisible,n.setNoneRole),this.Jt.ULS.Ge(588793046,A.H,U.Info,"Wac frame created")),this.Ss.setTargetFrame(this.Is,n.enforceSameWindow),r&&(this.bs=this.Is.parentElement),n.useFrameFixForTeams&&i.ULS.Ge(509143245,A.H,U.Info,"Frame fix enabled for teams uiHost"),function(e,t,i){f(t,Ve.Rr,String(i?window.outerHeight:e.offsetHeight)),f(t,Ve.Wr,String(i?window.outerWidth:e.offsetWidth)),f(t,Ve.jr,String(me())),f(t,Ve.Mr,String(ge())),f(t,Ve.Nr,String(Se())),f(t,Ve.$r,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}(this.Is,t,n.useFrameFixForTeams),this._s=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.vs,this.ws,this.ms,e,t);try{this._s.submit()}catch(e){this.Jt.ULS.Ge(507909977,A.H,U.Warning,"WAC frame failed to submit, will retry. Error: ".concat(X(e))),new Promise((function(e){window.setTimeout(e,10)})).then((function(){o._s.submit()})).catch((function(e){throw o.Jt.ULS.Ge(507909976,A.H,U.Error,"WAC frame failed to submit on retry. Error: ".concat(X(e))),e}))}},e.prototype.setVisibility=function(e){this.Is&&Ge(this.Is,e)},e.prototype.setMessageHandler=function(e){this.mr=e,this.Ss&&this.Ss.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.Ts=e},e.prototype.removeMessageHandler=function(){this.mr=void 0,this.Ss&&this.Ss.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Ts?this.Ts(e,t):this.Ss&&this.Ss.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i._s&&(i.vs.removeChild(i._s),i._s=void 0),i.Ss&&(i.Ss.dispose(),i.Ss=void 0,i.mr=void 0),i.Ts&&(i.Ts=void 0),i.Jt=void 0,!i.Is||!i.bs&&e)n();else{var o=function(){i.bs?(i.bs.removeChild(i.Is),i.vs.removeChild(i.bs)):i.vs.removeChild(i.Is),i.Is=void 0,i.bs=void 0,n()};t?o():(i.Is.src="about:blank",window.setTimeout(o,0))}}))},e}(),Ke=function(){function e(e,t,i){var n,o=this;this.sessions=[],this.containers=[],this.Cs=function(e){o.ys.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.Ps=e,this.As=t,this.Us=i,this.ys=new se,(n=e.host.owlVersion)&&(N.BUILD_NUMBER=n)}return Object.defineProperty(e.prototype,"name",{get:function(){return this.As.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return R()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.ys.add(e)},e.prototype.removeEventListener=function(e){this.ys.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.As.name,"_").concat(this.containers.length),i=new qe(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new Be(this.Ps,this.As,e,this,this.Cs,this.Us);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t.ys.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}(),Ze=function(e,t,i){return new Promise((function(t){i.logger.ULS.Ge(590111070,A.H,U.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))};function $e(e){return!(!(e&&e.source&&e.accessToken)||!e.expiry&&0!==e.expiry)}function Xe(e){return function(e,t){var i={};return t&&Object.keys(t).forEach((function(e){i[e.toLowerCase()]=t[e]})),e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");i[t[0].toLowerCase()]=t[1]}})),i}(window.location.search.substring(1),e)}function Qe(e,t,i){var n=j(j(j({},function(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}(e.appUrl)),function(e){var t={};f(t,"jsapi","1"),f(t,"jsapiver","v2"),f(t,"corrid",e.sessionId),f(t,"usid",e.sessionId),f(t,"newsession","1"),f(t,"sftc","1"),e.hostSessionId&&f(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&f(t,"uih",i.uiHostName),i.uiHostIntegrationType&&f(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&f(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&f(t,"accloop","1"),n.rebootDoc&&f(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&f(t,"scnd","1"),n.authToken&&f(t,"sat","1"),n.customAuthConfig&&f(t,"cac","1"),n.refreshAccessToken&&f(t,"rat","1"),n.atMentions&&f(t,"sams","1"),n.moveToFolder&&f(t,"mtf","1"),n.noBrowserModalDialogs&&f(t,"nbmd","1"),n.commonFilePicker&&f(t,"sfp","1"),n.directDownload&&f(t,"sdd","1"),n.directPrint&&f(t,"sdp","1"));var o=e.ui;o.language&&f(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&f(t,"uiembed","1"),(o.hideHeader||"DocGen"===o.contentAssemblyMode||"Templatization"===o.contentAssemblyMode||"ContentAssemblyEdit"===o.contentAssemblyMode||"ContentAssemblyView"===o.contentAssemblyMode)&&f(t,"hhdr","1"),o.highContrast&&f(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&f(t,"hodflp","1"),o.hideAppLauncherInHeader&&f(t,"halh","1"),o.hideChatInHeader&&f(t,"hch","1"),o.hideMeInHeader&&f(t,"hmh","1"),o.hideSearchInHeader&&f(t,"hsh","1"),o.hideWorkflowInHeader&&f(t,"hwfh","1"),o.hideSettingsInHeader&&f(t,"hsth","1"),o.showAppIconInHeader&&f(t,"sih","1"),o.useNeutralColorInHeader&&f(t,"unh","1"),o.openLinksInNewWindow&&f(t,"onw","1"),o.useDarkTheme&&f(t,"udt","1"),"DocGen"!==o.contentAssemblyMode&&"ContentAssemblyView"!==o.contentAssemblyMode||f(t,"readOnly","1");var r=e.wopi;r&&r.source&&f(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&f(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&f(t,"readonly","1"),s.disableChat&&f(t,"dchat","1"),s.cookieCompliant&&f(t,"mscc","1"),s.isNewFile&&(f(t,"new","1"),s.isFromHostTemplate&&f(t,"wdtpl","fromhost"))),e.user.isLicensed&&f(t,"islicenseduser","1"),e.user.isSynthetic&&f(t,"syn","1"),e.actNavId&&f(t,"actnavid",e.actNavId),e.sessionContext&&f(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)f(t,c,a[c]);var d=e.preseededSession;d&&(d.key&&f(t,"preseededsessionkey",encodeURIComponent(d.key)),d.id&&f(t,"preseededwacsessionid",encodeURIComponent(d.id)));var u=e.throttling;u&&(u.protection&&f(t,"ctp",u.protection),u.request&&f(t,"rct",u.request));var l=e.hostInitDiagnostics;l&&(l.entryPoint&&f(t,"wdorigin",encodeURI(l.entryPoint)),l.userClickTime&&f(t,"wdhostclicktime",l.userClickTime.toString()));var h=e.rebootOverride;return h&&h.previousSessionId&&f(t,"wdprevioussession",h.previousSessionId),p(t,"region"),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=j(j({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}function Ye(e,t){var i=function(e){var t={};f(t,"highdpi",String(window.devicePixelRatio>1.24)),f(t,"softblockedbrowser",String(we()===ce.IE&&!(we()===ce.IE&&null!=document.documentMode&&void 0!==document.documentMode&&document.documentMode>=11))),f(t,"hostname",e.hostName),f(t,"feature_status",Y(e.featureManager,e.wdParams)),f(t,"jsapibuild",R());var i=e.wopi;i&&(f(t,"access_token",i.accessToken),f(t,"access_token_ttl",i.expiry.toString()),i.wacToken&&f(t,"wac_token",i.wacToken));var n=e.customFontCatalogUrl;n&&f(t,"customfontcatalogurl",n);var o=e.contentBundle;if(o&&o.url){f(t,"bundlesrc",o.url);var r=o.staleness,s=null!=r;s&&f(t,Ve._r,r.toString()),e.logger.ULS.Ge(577783775,A.H,U.Info,"Content bundle staleness: "+(s?r:"N/A"))}var a=e.file,c=a.name;if(c){f(t,"filename",c);var d=Z(c);d&&f(t,"fileextension",d)}a.getUrl&&f(t,"filegeturl",a.getUrl),a.downloadCode&&f(t,"filedownloadcode",a.downloadCode),a.size&&f(t,"filesize",a.size.toString()),a.eTag&&f(t,"etag",a.eTag),a.cTag&&f(t,"revid",a.cTag),a.uniqueId&&f(t,"docid",a.uniqueId),void 0!==a.immutableReason&&f(t,"immutableReason",a.immutableReason.toString()),void 0!==a.supportsZipIt&&f(t,"supports_zipit",a.supportsZipIt.toString());var u=e.newFileTemplate;u&&(u.getUrl&&f(t,"templateurl",u.getUrl),u.size&&f(t,"filesize",u.size.toString()),u.eTag&&f(t,"etag",u.eTag),u.uniqueId&&f(t,"docid",u.uniqueId)),e.user.id&&f(t,"user_id",e.user.id),e.ownerId&&f(t,"owner_id",e.ownerId),e.sessionContext&&f(t,"sc",e.sessionContext);var l=e.ui;l.controls&&f(t,"huictrls",JSON.stringify(l.controls)),"Templatization"!==l.contentAssemblyMode&&"DocGen"!==l.contentAssemblyMode&&"ContentAssemblyEdit"!==l.contentAssemblyMode&&"ContentAssemblyView"!==l.contentAssemblyMode||f(t,"caae","1"),l.contentAssemblyMode&&f(t,"caaemode",l.contentAssemblyMode);var p=e.meeting;p&&(p.id&&f(t,"meetingId",p.id),p.title&&f(t,"meetingTitle",p.title),p.type&&f(t,"meetingType",p.type),p.scheduledStartTime&&f(t,"scheduledStartTime",p.scheduledStartTime),p.scheduledEndTime&&f(t,"scheduledEndTime",p.scheduledEndTime),p.isPresenter&&f(t,"isPresenter",p.isPresenter.toString()),p.organizerId&&f(t,"meetingOrganizerId",p.organizerId),p.joinUrl&&f(t,"meetingJoinUrl",encodeURIComponent(p.joinUrl)),p.isMeetingTeamsRoom&&f(t,"isMeetingTeamsRoom",p.isMeetingTeamsRoom.toString()));var h=e.host;return h.owlVersion&&f(t,"owlver",h.owlVersion),h.owlRollout&&f(t,"owlro",h.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}var et=function(e,t,i,n,o){return e!==te.createNew?Promise.reject("Wrong flow"):new Promise((function(r){var s={wopiPendingInitializeTime:D()},a=!!(n&&n.parallelizeStartSessionRequest&&n.buildStartSessionRequestParams)&&n.parallelizeStartSessionRequest(i),c=!1,d=!1,u=!1,l=!1,f=void 0,p=void 0,h=!1,v=!1;if(we()===ce.IE||n&&n.fallBackToSingleStepBootFlow&&n.fallBackToSingleStepBootFlow(i,t))!function(){i.logger.ULS.Ge(578074079,A.H,U.Info,"Waiting for WOPI info to start boot");var e=function(e,r){if(c)i.logger.ULS.Ge(578074080,A.H,U.Warning,"completeCreateNew already called");else{if(c=!0,s.wopiPendingCompleteTime=D(),"failure"===r.state)return O(r.reason),i.state=P.Failed,void n({completion:"failure"});tt(r.newFile),i.run(te.boot,j(j({},t),{wopi:r.wopi}),o).then((function(e){n(e)}))}};i.addActionHandler(te.completeCreateNew,e);var n=function(t){i.removeActionHandler(te.completeCreateNew,e),r(t)};o&&o.subscribe((function(){n({completion:"cancelled"})}))}();else{var w=function(e,t){c?i.logger.ULS.Ge(587236372,A.H,U.Warning,"completeCreateNew already called"):(c=!0,s.wopiPendingCompleteTime=D(),"failure"!==t.state?$e(f=t.wopi)?(i.wopi=f,i.logger.ULS.Ge(587286030,A.H,U.Info,"WOPI info received. Access token: "+JSON.stringify({length:f.accessToken.length,expiry:f.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:a,wacFrameLoaded:d,wacCanAcceptStartSessionResponse:u})),!a||d&&!u?d&&_():g(),d&&i.container&&i.container.postMessage(ne.Fo,void 0),tt(t.newFile)):m("InvalidWopiInfo"):m(t.reason))},m=function(e){O(e),d&&i.container&&i.container.postMessage(ne.Eo,void 0)},g=function(){i.logger.ULS.Ge(587233056,A.H,U.Info,"Making parallelized StartSession request");var t=n.buildStartSessionRequestParams(i,e,f),o=Qe(i,t.appPageName,t.queryParamsOverrides),r="access_token="+encodeURIComponent(f.accessToken)+"&access_token_ttl="+encodeURIComponent(f.expiry.toString());s.startSessionStartTime=D(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(o,r,{"Content-Type":"application/x-www-form-urlencoded"},S)},S=function(e){var t=D();s.startSessionCompleteTime=t,i.logger.ULS.Ge(587233057,A.H,U.Info,"StartSession request completed. Status code: ".concat(e.status,", time: ").concat(t)),p={RequestStatus:e.status,ResponseText:e.responseText},d&&u?b():i.logger.ULS.Ge(587233058,A.H,U.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:d,wacCanAcceptStartSessionResponse:u,wopiInfoSent:h,startSessionResponseSent:v}))},I=function(e,t){s.readyMessageReceiveTime=D(),i.container&&i.container.postMessage(ne.Kn,void 0),d||(d=!0,u=t.CanAcceptStartSessionComplete,i.logger.ULS.Ge(587321567,A.H,U.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:a,wacCanAcceptStartSessionResponse:u,startSessionResponseAvailable:!!p,wopiInfoAvailable:!!f})),c&&i.container&&i.container.postMessage(f?ne.Fo:ne.Eo,void 0),a&&u?b():_(),Ce(i.appInitDiagnostics,t.Diagnostics))},b=function(){v||h||!p||(200===p.RequestStatus?(v=!0,s.completeMessageCreateTime=D(),T(ne.Yn,{StartSessionResponse:p,Diagnostics:s},3)):_())},_=function(){v||h||!f||(h=!0,s.completeMessageCreateTime=D(),n&&n.sendCreateNewWopiInfo?n.sendCreateNewWopiInfo(i):T(ne.eo,{WopiDetails:{WopiSrc:f.source,AccessToken:f.accessToken,AccessTokenTtl:f.expiry.toString()},Diagnostics:s},3))},T=function(e,t,n){var o=D();n<=0?i.logger.ULS.Ge(587233165,A.H,U.Error,"Attempted to complete but no ack. Time: ".concat(o)):(i.logger.ULS.Ge(587233166,A.H,U.Info,"Sending complete message. Retries left: ".concat(n-1,", Time: ").concat(o)),s.completeMessageSendTime=o,i.container&&i.container.postMessage(e,t),window.setTimeout(C,1e3,e,t,n-1))},C=function(e,t,n){l||(i.logger.ULS.Ge(587233167,A.H,U.Info,"Timeout session complete ack. Retries left: ".concat(n)),T(e,t,n))},y=function(e,t){l=!0},E=function(e){i.removeActionHandler(te.completeCreateNew,w),i.removeActionHandler(ie.ii,I),i.removeActionHandler(ie.zi,y),r(e)};i.addActionHandler(te.completeCreateNew,w),i.addActionHandler(ie.ii,I),i.addActionHandler(ie.zi,y),o&&o.subscribe((function(){E({completion:"cancelled"})})),i.skipWopiValidation=!0,i.skipFileNameCheck=!0,i.wopi=void 0,i.run(te.boot,t,o).then((function(e){i.skipWopiValidation=!1,i.wopi=f,E(e)}))}function O(e){i.logger.ULS.Ge(596444188,A.H,U.Warning,"Fail with reason: "+(e?JSON.stringify(e):"N/A"))}}))};function tt(e){e&&(e.path&&history.replaceState({},"",e.path),e.title&&(document.title=e.title))}var it=function(){function e(e){var t=this;this.Es=!1,this.Os="",this.Fs=[],this.ks=function(e){t.Es||(t.Es=!0,t.Os=e?"timeout":"cancelled",t.Fs.map((function(e){return e()})),t.Fs=[])},this.Ns=e,window.setTimeout((function(){return t.ks(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.Es},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.Ns},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.Os},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.ks(!1)},e.prototype.subscribe=function(e){this.Es?e():this.Fs.push(e)},e}();function nt(e){return new it(e)}var ot,rt=function(e,t,i,n,o){return e!==te.dispose?Promise.reject("Wrong flow"):new Promise((function(e){i.logger.ULS.Ge(595714433,A.H,U.Info,"start disposing the application");var r=i.host.requireExplicitUnload,s={disposeStartTime:D(),forceAppUnload:r};i.state=P.Disposing;var a=function(){i.state=P.Disposed,e({completion:"success"})},c=function(e){n&&n.disposeAppSpecificResources&&n.disposeAppSpecificResources(i,t),i.dispose(),s.disposeEndTime=D(),function(e,t,i){if(i){var n=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-t.appUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.Ge(592524822,A.H,U.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,s,e),i.container?i.container.dispose(i.pendingReboot,r).then(a):a()};r?(s.appUnloadStartTime=D(),i.addActionHandler(ie.Qi,(function(e,t){s.appUnloadEndTime=D(),c(t)})),(o||new it(5e3)).subscribe((function(){i.state===P.Disposing&&(s.appUnloadTimedOut=!0,c())})),i.container&&i.container.postMessage(ne.No,void 0)):c()}))},st=function(e,t,i,n,o){return e!==ie.Ti?Promise.reject("Wrong flow"):new Promise((function(e){if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(oe.FrameTrust,t);else{var n=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.Ge(592445957,A.H,U.Info,"Top frame is trusted: ".concat(n)),i.container&&i.container.postMessage(ne.Ti,{isTopFrameTrusted:n})}e({completion:"success"})}))},at=function(e,t,i,n,o){return e!==ie.yi?Promise.reject("Wrong flow"):new Promise((function(e){i.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(n){n?i.raiseEvent(oe.GetAuthToken,t):(i.container.postMessage(ne.So,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(n){i.container.postMessage(ne.So,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:n})}))}))},ct=function(e,t,i,n,o){return e!==ie.oi?Promise.reject("Wrong flow"):new Promise((function(e){var o=t&&t.state?t.state:"Unknown";i.logger.ULS.Ge(592839750,A.H,U.Info,"Boot state: [".concat(o,"]")),n&&n.beforeComplete&&n.beforeComplete(o),e({completion:"success"})}))},dt=function(e,t,i,n,o){if(e!==te.postWacToken)return Promise.reject("Wrong flow");var r=M();return i.logger.ULS.Ge(507774685,A.H,U.Important,"postWacToken flow initiated"),new Promise((function(e){var n=function(e,t){i.logger.ULS.Ge(507597017,A.H,U.Info,"postWacToken flow completed in ".concat(M()-r," ms")),window.clearInterval(a),window.clearTimeout(c);var n={completion:"success"};t&&void 0!==t.TokenAlreadySet&&(n.data={TokenAlreadySet:t.TokenAlreadySet}),o(n)},o=function(t){i.removeActionHandler(ie.Jn,n),e(t)},s=function(){var e;return null===(e=i.container)||void 0===e?void 0:e.postMessage(ne.Jo,t)};i.addActionHandler(ie.Jn,n),s();var a=window.setInterval(s,100),c=window.setTimeout((function(){window.clearInterval(a),i.logger.ULS.Ge(507844190,A.H,U.Warning,"postWacToken flow timed out after ".concat(6e4," milliseconds")),o({completion:"timeout"})}),6e4)}))},ut=function(e,t,i,n,o){return e!==te.rename?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(ie.Si,n),i.removeActionHandler(ie.Ii,r),e(t)};i.addActionHandler(ie.Si,n),i.addActionHandler(ie.Ii,r),(o||new it(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(ne.wo,t)}))},lt=function(e,t,i,n,o){return e!==ie.qi?Promise.reject("Wrong flow"):new Promise((function(e){var n,o;n=t.overlayContent,(o=window.navigator)&&o.virtualKeyboard&&void 0!==o.virtualKeyboard.overlaysContent&&window===top&&(o.virtualKeyboard.overlaysContent=n),i.container&&i.container.postMessage(ne.Oo,void 0),e({completion:"success"})}))},ft=function(e,t,i,n,o){return e!==ie.zn?Promise.reject("Wrong flow"):new Promise((function(e){var n,o=t.flightKey,r=t.flightValue;i.logger.ULS.Ge(507343134,A.Ie,U.Info,"setWacFlightValue ".concat(o,": ").concat(r)),n=t,localStorage.setItem(n.flightKey,n.flightValue.toString()),e({completion:"success"})}))};!function(e){e[e.NotCreateNew=0]="NotCreateNew",e[e.UnifiedCreateNew=1]="UnifiedCreateNew",e[e.LegacyCreateNew=2]="LegacyCreateNew"}(ot||(ot={}));var pt,ht="powerpoint.officeapps.live.com",vt="https://ffc-"+ht,wt="https://ppc-"+ht,mt="https://eurppc-"+ht,gt="https://usc-"+ht,St="https://euc-"+ht,It="https://cac-"+ht,bt="https://ukc-"+ht,_t="https://auc-"+ht,Tt="https://jpc-"+ht,Ct="https://inc-"+ht,yt="https://krc-"+ht,Pt="https://frc-"+ht,At="https://sgc-"+ht,Ut="https://zac-"+ht,Et="https://aec-"+ht,Ot="https://gbc-"+ht,Ft="https://dec-"+ht,kt="https://chc-"+ht,Nt="https://noc-"+ht,Rt="https://brc-"+ht,Wt="https://sec-"+ht,Mt="https://qtc-"+ht,Dt="https://plc-"+ht,xt="https://"+ht,Bt="https://cnc-powerpoint.partner.officewebapps.cn",Ht="https://powerpoint.gov.online.office365.us",Lt="https://powerpoint.dod.online.office365.us",Vt="https://powerpoint.wac.online.office.eaglex.ic.gov",Jt="https://powerpoint.wac.online.office.microsoft.scloud",Gt="https://devpr.officeapps.live-int.com",jt="https://c4-powerpoint-15.cdn.office.net/pods/s/",zt="https://c1-powerpoint-15.cdn.office.net/pods/s/",qt=((pt={})[vt]=Zt(vt,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),pt[wt]=Zt(wt,jt),pt[mt]=Zt(mt,jt),pt[xt]=Zt(xt),pt[gt]=Zt(gt),pt[St]=Zt(St),pt[It]=Zt(It),pt[bt]=Zt(bt),pt[_t]=Zt(_t),pt[Tt]=Zt(Tt),pt[Ct]=Zt(Ct),pt[yt]=Zt(yt),pt[Pt]=Zt(Pt),pt[At]=Zt(At),pt[Ut]=Zt(Ut),pt[Et]=Zt(Et),pt[Ft]=Zt(Ft),pt[kt]=Zt(kt),pt[Nt]=Zt(Nt),pt[Rt]=Zt(Rt),pt[Wt]=Zt(Wt),pt[Mt]=Zt(Mt),pt[Dt]=Zt(Dt),pt["https://powerpoint.online.office.de"]=Zt("https://powerpoint.online.office.de","https://powerpoint.cdn.office.de/pods/s/"),pt[Bt]=Zt(Bt,"https://cdn.partner.officewebapps.cn/pods/s/"),pt[Ht]=Zt(Ht,"https://powerpoint.cdn.office365.us/pods/s/"),pt[Ot]=Zt(Ot,"https://powerpoint.cdn.office365.us/pods/s/"),pt[Lt]=Zt(Lt,"https://powerpoint.dod.cdn.office365.us/pods/s/"),pt[Vt]=Zt(Vt,"https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/"),pt[Jt]=Zt(Jt,"https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/"),pt[Gt]=Zt(Gt,Gt+"/pods/s/"),pt),Kt={"https://ffc-powerpoint.officeapps.live.com":"ring1","https://ppc-powerpoint.officeapps.live.com":"ring2_2","https://eurppc-powerpoint.officeapps.live.com":"ring2_1","https://powerpoint.officeapps.live.com":"ring5_3","https://usc-powerpoint.officeapps.live.com":"ring5_3","https://euc-powerpoint.officeapps.live.com":"ring5_3","https://cac-powerpoint.officeapps.live.com":"ring5_2","https://ukc-powerpoint.officeapps.live.com":"ring5_2","https://auc-powerpoint.officeapps.live.com":"ring5_2","https://jpc-powerpoint.officeapps.live.com":"ring5_2","https://inc-powerpoint.officeapps.live.com":"ring5_2","https://krc-powerpoint.officeapps.live.com":"ring5_2","https://frc-powerpoint.officeapps.live.com":"ring5_2","https://sgc-powerpoint.officeapps.live.com":"ring5_2","https://zac-powerpoint.officeapps.live.com":"ring5_2","https://aec-powerpoint.officeapps.live.com":"ring5_2","https://dec-powerpoint.officeapps.live.com":"ring5_1","https://chc-powerpoint.officeapps.live.com":"ring5_1","https://noc-powerpoint.officeapps.live.com":"ring5_1","https://brc-powerpoint.officeapps.live.com":"ring5_1","https://sec-powerpoint.officeapps.live.com":"ring5_1","https://qtc-powerpoint.officeapps.live.com":"ring5_1","https://plc-powerpoint.officeapps.live.com":"ring5_0"};function Zt(e,t){return void 0===t&&(t=zt),{PodsUrl:e+"/pods/",WacCdnStaticServer:t}}function $t(e){var t=e.substring(0,e.indexOf("/p/"));return qt[t.toLowerCase()]}var Xt=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"];function Qt(e,t,i){if(!t)return e;var n=e,o=null==i,r=n.indexOf("?");if(-1===r)return o?e:n+"?"+t+"="+i;for(var s=n.substr(r+1),a=s.split("&"),c=t+"=",d=!1,u=0;u<a.length;u+=1)if(0===a[u].indexOf(c)){n=n.replace(a[u],o?"":c+i),d=!0;break}return d||o||(s.length>0&&(n+="&"),n+=c+i),n}function Yt(e,t){return!e||"wd"!==e.substring(0,2)||Xt.indexOf(e)>=0?"":e+"="+t}function ei(e){for(var t=e,i="",n=0,o=window.location.search.substring(1).split("&");n<o.length;n++){"wdoverrides"===(d=o[n].split("="))[0]&&(i=d[1]);var r=Yt(d[0],d[1]);r&&(t+="&"+r)}for(var s=[],a=0,c=(i=i||"").split(/,|%2C/);a<c.length;a++){var d;2===(d=c[a].split(/:|%3A/)).length&&"devicepixelratio"!==d[0].toLowerCase()&&s.push(d[0]+":"+d[1])}return s.push("devicepixelratio:"+_e()),s.push("RenderGifSlideShow:true"),Qt(t,"wdoverrides",s.join(","))}function ti(e){var t=I("wdPodsUrl");return t&&!T(t)&&(t=""),t||(t=e),"/"!==t.substr(t.length-1)&&(t+="/"),t}function ii(e,t){var i=e.bootParams,n=e.file;if(!i.isNewFile){if(!n.getUrl)throw Error("Missing FileGetUrl");if(!n.name)throw Error("Missing FileName")}var o=e.preseededSession;o&&o.key&&("_._._."===o.key.slice(0,6)&&"-.-.-."===o.key.slice(-6)||(o.key="_._._."+o.key+"-.-.-."));var r=e.appContext;r.wopiInfoSent=!1,r.bootComplete=!1,r.bootFlowResolve=t,r.bootRecorded=!1;var s=qt[e.appBaseUrl];e.appBasePath=s?s.PodsUrl:e.appBaseUrl+"/pods/";var a=e.wdParams,c=a.wdpodsurl;c&&!T(c)&&(c=""),c||(c=e.appBasePath);var d=/\/$/;if(d.test(c)||(c+="/"),!c)throw Error("Invalid PODS URL");r.podsUrl=c;var u=a.wdpopsurl;if(u&&!T(u)&&(u=""),u||(u=(u=c).substring(0,u.indexOf("/pods/"))),d.test(u)||(u+="/"),!u)throw Error("Invalid POPS URL");r.popsUrl=u,e.bootstrapperUrl?r.cdnBasePath=e.bootstrapperUrl.split("/pods/s/")[0]+"/pods/s/":r.cdnBasePath=s?s.WacCdnStaticServer:zt,r.createNewScenario=function(e,t,i,n){var o=ot.NotCreateNew,r="NotCreateNew";t.isNewFile?i.size?(o=ot.LegacyCreateNew,r="CreateNewWithNonZeroByteFile"):(o=ot.UnifiedCreateNew,r="IsNewFile"):t.isFromHostTemplate?(o=ot.UnifiedCreateNew,r="CreateNewFromHostTemplate"):n&&n.getUrl&&(o=ot.UnifiedCreateNew,r="CreateNewFromTemplateSourceUrl");var s={CreateNewScenario:ot[o],reason:r};return e.ULS.Ge(34932951,A.H,U.Info,JSON.stringify(s)),o}(e.logger,i,n,e.newFileTemplate),r.shouldUsePods=function(e,t,i,n,o,r,s){var a=!1,c=!1,d="";t?(a="false"!==t,c=!0,d="wdPodsEnabled is available"):i?e===ot.LegacyCreateNew?(a=!1,c=!1,d="Legacy Create New Scenario because non-zero file size"):n?(a=!1,c=!1,d="Embed View fallback to WAC"):(a=!0,c=!0,d="Supported Region"):(a=!1,c=!1,d="Wac region not currently supported by PODS",s.ULS.Ge(589168768,A.H,U.Warning,d+": "+r)),o||e!==ot.NotCreateNew||(a=!1,c=!1,d+=" | FileGetUrl is empty");var u={ShouldUsePodsOrCached:a,ShouldUsePods:a,CanUsePods:c,ApplicationUrl:r,Reason:d,CreateNewScenario:ot[e]};return s.ULS.Ge(561640788,A.H,U.Info,JSON.stringify(u)),a}(r.createNewScenario,a.wdpodsenabled,!!s,g(e.appUrl,"embed"),!!n.getUrl,C(e.appBaseUrl),e.logger);var l=e.hostInitDiagnostics;l&&l.userClickTime&&Oe(l.userClickTime,e.logger),function(e){var t=e.hostInitDiagnostics,i=e.bootParams,n=e.file,o=!!n.getUrl,r=!!e.customFontCatalogUrl,s=e.contentBundle,a={BootstrapperType:"TypeScript",JsApiVersion:"v2",Preview:!1,Scenario:"Unified App",ApplicationUrl:C(e.appBaseUrl),IsDeepLink:!!I("nav"),BootstrapperInstanceId:le(),IsMobileView:be(),ApplicationCustomSettings:{OnDemandServer:C(e.appBasePath),EnableWacFallback:!0},SessionInformation:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:i.dataLanguage,DocumentClickTime:t.userClickTime,CurrentTime:D(),UiHost:e.host.uiHostName,WdParams:e.wdParams},Diagnostics:{EntryPoint:t.entryPoint,FileHost:e.host.storageHostName,PodsRing:"",UnifiedUiHostDiagnostics:t.unifiedUiHostDiagnostics},WopiPrecheckInfo:{FileSize:n.size,FileGetUrlBool:o,CustomFontCatalogBool:r,FileGetUrlLength:o?n.getUrl.length:null,FileNameBool:!!n.name,ReadOnly:i.readOnly,IrmEnabled:i.irmEnabled,SupportsDecryptedContentDownload:i.supportsDecryptedContentDownload,ViewOnly:i.viewOnly,PreseededSessionKey:!!e.preseededSession&&!!e.preseededSession.key,FileExtension:Z(n.name)||null,BundleInfo:s?{MajorVersion:s.majorVersion,URLBool:!!s.url}:{}},AppInfo:{AppVersionMajor:1,AppVersionMinor:20240421007,Environment:"wac",UserAgent:window.navigator.userAgent},AdditionalTelemetry:{PostMessageToken:e.sessionId}};e.logger.ULS.Ge(22357763,A.H,U.Info,JSON.stringify(a,$))}(e)}function ni(e){return e.appBasePath}function oi(e){return e.appBasePath+"RemoteTelemetry.ashx"+((t=e.sessionId)?"?usid="+t:"");var t}function ri(e){return!e.appContext.shouldUsePods}var si,ai="\n  @media screen and (-ms-high-contrast:active)\n  {\n   div#".concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n   {\n  \tbackground-image: none !important;\n   }\n  }\n\n  div#").concat("highContrastDetectionDiv","\n  {\n   background-color: Window;\n   position: absolute;\n   top: 0px;\n   left: -99999px;\n   width: 1px;\n   height: 1px;\n   opacity: 0;\n   overflow: hidden;\n  }\n\n  div#").concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n  {\n   background-image: url('data:image/png;base64,").concat("highcontrastdetectordefault","');\n  }\n");function ci(e){var t=e.ownerDocument.createElement("div");t.id="highContrastDetectionDiv",t.ariaHidden="true";var i=e.ownerDocument.createElement("a");i.id="highContrastDetectionAnchor",i.setAttribute("href","#"),i.ariaHidden="true",t.appendChild(i),e.appendChild(t);var n=e.ownerDocument.createElement("style");n.innerHTML=ai,e.ownerDocument.head.appendChild(n);var o=function(){e.ownerDocument.head.removeChild(n),e.removeChild(t)},r=li(t),s=li(i);if(r&&s){if(-1===s.backgroundImage.toLowerCase().indexOf("highcontrastdetectordefault")){var a=function(e,t,i){var n=di(e),o=di(t),r=di(i);if(n&&o&&r)return{foregroundTextColor:n,backgroundColor:o,linkColor:r}}(r.color.toLowerCase(),r.backgroundColor.toLowerCase(),s.color.toLowerCase());return o(),{isInHighContrastMode:!0,highContrastColors:a}}return o(),{isInHighContrastMode:!1}}o()}function di(e){return new RegExp("#[0-9A-Fa-f]{6}").test(e)?e:"transparent"===e||"window"===e?"transparent":function(e){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(t&&4===t.length)return function(e,t,i){return"#"+ui(Number(e),2)+ui(Number(t),2)+ui(Number(i),2)}(t[1],t[2],t[3])}(e)}function ui(e,t){for(var i=e.toString(16);i.length<t;)i="0"+i;return i.toLowerCase()}function li(e){if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle)return e.ownerDocument.defaultView.getComputedStyle(e)}function fi(){var e,t,i,n=((i=(t={width:(e={width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight-50}).width,height:e.height}).width<320)&&(t.height-=17),t.height<256&&(t.width-=17),!i&&t.width<320&&(i=!0,t.height-=17),t.width=Math.max(t.width,320),t.height=Math.max(t.height,256),t);return(""+document.cookie).indexOf("WACRibbonMinimizedPPT=true")>=0&&(n.height-=me()?108:94),n.height-=30,n.height-=23,n}function pi(e){var t,i;return(i={width:(t={height:e.height-32-1,width:e.width-238-1-17}).width-20,height:t.height-20}).width<424?i.width=424:i.width>1696&&(i.width=1696),i.height<238.5?i.height=238.5:i.height>954&&(i.height=954),i}function hi(e){return e.Diagnostics&&e.Diagnostics.entryPoint?e.Diagnostics.entryPoint:e.ApplicationUrl&&S(e.ApplicationUrl,"wdOrigin")||null}function vi(e,t,i){if(e)for(var n=0;n<e.length;n+=1){var o=e[n];if(o.name.indexOf(t)>=0)return o.name.toLowerCase()!==t.toLowerCase()&&i.ULS.Ge(38147726,A.H,U.Info,"Found partial match for bootstrapper URL perf entry"),o}}function wi(e,t){if(t)try{if(!e)return void t.ULS.Ge(557454687,A.H,U.Info,"Missing BootstrapperUrl");if(!window.performance)return void t.ULS.Ge(557454688,A.H,U.Info,"Performance API not found on browser");var i=void 0;if(window.performance.getEntriesByName&&(i=vi(window.performance.getEntriesByName(e),e,t)),!i&&window.performance.getEntries&&(t.ULS.Ge(557454689,A.H,U.Info,"Searching all entries for bootstrapper timing entry"),i=vi(window.performance.getEntries(),e,t)),!i)return void t.ULS.Ge(557454690,A.H,U.Info,"Unable to extract Bootstrapper perf info");var n={name:e,logReason:"UnifiedTSBoot",nameMatchesExpected:i.name===e,connectEnd:i.connectEnd,connectStart:i.connectStart,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,fetchStart:i.fetchStart,initiatorType:i.initiatorType,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,duration:i.duration,entryType:i.entryType,startTime:i.startTime,nextHopProtocol:i.nextHopProtocol,workerStart:i.workerStart,secureConnectionStart:i.secureConnectionStart,transferSize:i.transferSize,encodedBodySize:i.encodedBodySize,decodedBodySize:i.decodedBodySize};t.ULS.Ge(34928845,A.H,U.Info,JSON.stringify(n))}catch(e){t.ULS.Ge(557454691,A.ae,U.Warning,"Exception extracting Bootstrapper perf info: ".concat(X(e)))}}function mi(e){return!e||e.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):e}function gi(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return e;default:return""}}function Si(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return e}}function Ii(e,t,i){if(e){var n="Page lifecycle: "+t+" fired.";i&&(n+="Flushing ULS logger",e.ULS.flushOnClose()),e.ULS.Ge(579384268,A.H,U.Warning,n)}}function bi(e){return e.toLocaleLowerCase().indexOf("pod")>=0||e.toLocaleLowerCase().indexOf("pop")>=0}function _i(e){var t="";for(var i in e)bi(i)||(t+="&"+i+"="+e[i]);return t}function Ti(e){var t,i=e.wdParams,n=be(),o="true"===i.wdembedview||g(e.appUrl,"embed"),r=e.appContext,s=n?"pptmobileapp.aspx":o?"pptembed.aspx":"ppt.aspx",a={},c={};Xt.forEach((function(e){p(a,e)}));var d=["devicepixelratio:"+_e(),"RenderGifSlideShow:true"],u=i.wdoverrides;u&&u.split(/,|%2C/).forEach((function(e){var t=e.split(/:|%3A/);2===t.length&&"devicepixelratio"!==t[0].toLowerCase()&&d.push(t[0]+":"+t[1])})),f(a,"wdoverrides",d.join(",")),o&&(p(a,"corrid"),p(a,"usid")),me()&&f(c,"touchdevice","1");var l=window.document.documentElement;l&&(void 0!==l.clientWidth&&f(c,"windowwidth",l.clientWidth.toString()),void 0!==l.clientHeight&&f(c,"windowheight",l.clientHeight.toString()));var v=I("previoussessionid");if(v&&f(c,"previoussessionid",v),e.featureManager.isFeatureEnabled(J.Dt)||(null===(t=e.je)||void 0===t?void 0:t.getValue(B.wt,!1))){var w=null===window||void 0===window?void 0:window._wopiContextJson;if(null==w?void 0:w.PredictedOfficeAppEndPointHintForRealSession){var m=null==w?void 0:w.PredictedOfficeAppEndPoint;if(m)if(e.je.getValue(B._t,!1)){var S=null==w?void 0:w.PredictedOfficeAppEndPointAccessTime;if(S){var T=new Date(S);((new Date).getTime()-T.getTime()+3e5)/36e5<=e.je.getValue(B.bt,48)&&f(a,"wdwaccluster",m)}else e.logger.ULS.Ge(507299216,A.H,U.Important,"PredictedOfficeAppEndPointAccessTime is null")}else f(a,"wdwaccluster",m)}}Ee()&&f(c,"lssupported","1");var C=e.host.capabilities;C&&(C.rebootDoc&&(f(c,"sdr",C.rebootDoc.toString()),p(a,"sdr")),C.createNewDoc&&(f(c,"scnd","1"),p(a,"scnd")),C.authToken&&(f(c,"sat","1"),p(a,"sat")),C.customAuthConfig&&(f(c,"cac","1"),p(a,"cac")),C.refreshAccessToken&&(f(c,"rat","1"),p(a,"rat")),C.atMentions&&(f(c,"sams","1"),p(a,"sams")),C.moveToFolder&&(f(c,"mtf","1"),p(a,"mtf")),C.noBrowserModalDialogs&&(f(c,"nbmd","1"),p(a,"nbmd")),C.commonFilePicker&&(f(c,"sfp","1"),p(a,"sfp")),C.directDownload&&(f(c,"sdd","1"),p(a,"sdd")),C.directPrint&&(f(c,"sdp","1"),p(a,"sdp")));var y=e.ui;(y.hideHeader||"DocGen"===y.contentAssemblyMode||"Templatization"===y.contentAssemblyMode||"ContentAssemblyEdit"===y.contentAssemblyMode||"ContentAssemblyView"===y.contentAssemblyMode)&&(f(c,"hhdr","1"),p(a,"hhdr")),y.hideFileLocationPicker&&(f(c,"hodflp","1"),p(a,"hodflp")),y.hideAppLauncherInHeader&&(f(c,"halh","1"),p(a,"halh")),y.hideChatInHeader&&(f(c,"hch","1"),p(a,"hch")),y.hideMeInHeader&&(f(c,"hmh","1"),p(a,"hmh")),y.hideSearchInHeader&&(f(c,"hsh","1"),p(a,"hsh")),y.hideWorkflowInHeader&&(f(c,"hwfh","1"),p(a,"hwfh")),y.hideSettingsInHeader&&(f(c,"hsth","1"),p(a,"hsth")),y.showAppIconInHeader&&(f(c,"sih","1"),p(a,"sih")),y.useNeutralColorInHeader&&(f(c,"unh","1"),p(a,"unh")),e.hostName&&f(c,"filesrc",e.hostName),e.user.id&&f(c,"userid",e.user.id),y.openLinksInNewWindow&&(f(c,"onw","1"),p(a,"onw")),y.useDarkTheme&&(f(c,"udt","1"),p(a,"udt"));var P=e.viewMode;P&&P.hideToolbar&&f(c,"hvt","1");var E=e.file;E.name&&(f(a,"filename",b(E.name)),p(c,"filename")),E.getUrl&&(f(c,"fileurl",E.getUrl),p(c,"filegeturl")),f(a,"filegeturlbool",E.getUrl?"true":"false"),E.size&&(f(a,"fs",E.size.toString()),p(c,"filesize"));var O=e.newFileTemplate;O&&O.size&&(f(a,"fs",O.size.toString()),p(c,"filesize"));var F=e.contentBundle;F&&F.url&&(f(c,"bundleurl",F.url),p(c,"bundlesrc"));var k=e.bootParams;k.irmEnabled&&f(c,"irmenabled",k.irmEnabled.toString()),k.supportsDecryptedContentDownload&&f(c,"supportsdecryptedcontentdownload",k.supportsDecryptedContentDownload.toString()),k.readOnly&&p(a,"readonly"),f(a,"ro",k.readOnly?k.readOnly.toString():"false"),k.viewOnly&&f(c,"viewonly",k.viewOnly.toString()),k.openViewByDefault&&f(c,"ovbd",k.openViewByDefault.toString());var N=e.preseededSession;N&&(N.key&&(o||f(c,"preseededsessionkey",N.key),p(a,"preseededsessionkey")),N.id&&p(a,"preseededwacsessionid"));var R=e.throttling;R&&(R.protection&&(f(c,"ctp",R.protection),p(a,"ctp")),R.request&&(f(c,"rct",R.request),p(a,"rct")));var W=I("nav");if(W||(W=e.actNavId?e.actNavId:h(e.appUrl,"actnavid")),W){try{var M=_(W),D=JSON.parse(M),x=D.sId;x&&(f(a,"wdslideid",x),f(a,"dc","1"));var H=D.commentId;H&&"null"!==H&&f(a,"wdcommentid",H);var L=D.openMode;L&&"null"!==L&&f(a,"wdopenmode",L)}catch(t){e.logger.ULS.Ge(560329684,A.H,U.Error,"Failed to parse navigation id: ".concat(W))}p(a,"actnavid")}if(r.shouldUsePods){e.appBasePath=r.podsUrl,p(a,"powerpointview"),f(a,"wdpodsurl",b(r.podsUrl)),f(a,"wdpopsurl",b(r.popsUrl)),f(a,"fastboot","true"),f(a,"noauth","1");var V=fi(),G=pi(V);f(a,"thpanel",V.height.toString()),f(a,"sw",G.width.toString()),f(a,"sh",G.height.toString());var j=i.wdfs;j&&f(a,"fslide",j);var z=i.wdfsection;z&&f(a,"fsection",z),(j||z||i.wdincludehosturl&&"false"!==i.wdincludehosturl)&&f(a,"frameurl",b(window.location.href));var q=I("automation");q&&f(a,"automation",q);var K=I("startrehearsal");if(K&&f(a,"startrehearsal",K),f(a,"postmessagetoken",e.sessionId),f(c,"postmessagetoken",e.sessionId),e.wdParams){var Z=_i(e.wdParams);Z&&f(c,"wdparams",Z)}if(f(c,"jsapiversionminor",20240421007..toString()),(X=e.wopi)&&X.source&&(f(c,"wopisrc",X.source),p(a,"wopisrc")),e.container){var $=ci(e.container.element);$&&$.isInHighContrastMode&&(f(c,"isinhighcontrastmode","true"),$.highContrastColors&&f(c,"clientcolorsettings",$.highContrastColors.foregroundTextColor+"_"+$.highContrastColors.backgroundColor+"_"+$.highContrastColors.linkColor))}}else{e.appBasePath||f(a,"nolog","True");var X,Q=e.appUrl.substring(0,e.appUrl.indexOf("?")),Y=Q.lastIndexOf("/")+1;if(e.appBasePath=Q.substring(0,Y),s=Q.substring(Y),(X=e.wopi)&&X.source){var ee=X.source;ee.toLowerCase().indexOf("powerpointframe.aspx")>=0&&(ee=decodeURIComponent(h(ee,"wopisrc"))),f(a,"wopisrc",b(ee))}f(a,"wdenableroaming","1"),f(a,"wdo","1")}return{appPageName:s,queryParamsOverrides:a,postDataOverrides:c}}function Ci(e){if(e.appContext.shouldUsePods){var t=function(i,n){yi(e),e.removeActionHandler(ie.ii,t)};e.addActionHandler(ie.ii,t),e.addActionHandler(ie.Yi,(function(t,i){t===ie.Yi&&function(e,t){var i=t;if(i&&"number"==typeof i.Tag&&"number"==typeof i.Category&&"number"==typeof i.Level&&"string"==typeof i.Message)try{e.logger.ULS.Ge(i.Tag,i.Category,i.Level,i.Message)}catch(t){e.logger.ULS.Ge(512235072,A.H,U.Error,"ulsLog exception: "+t)}}(e,i)}))}wi(e.bootstrapperUrl,e.logger),window.setTimeout((function(){e.logger.ULS.flush()}),1e4)}function yi(e){var t,i,n=e.appContext;if(!n.wopiInfoSent&&e.wopi){n.wopiInfoSent=!0;var o="";e.wdParams&&(o=Object.keys(e.wdParams).filter((function(e){return!/po[d/p]/i.test(e)})).reduce((function(t,i){return"".concat(t,"&").concat(i,"=").concat(e.wdParams[i])}),""));var r=e.bootParams,s=e.wopi,a=e.hostInitDiagnostics,c={WopiSrc:s.source,AccessToken:s.accessToken,AccessTokenTTL:s.expiry,ReadOnly:r.readOnly,IrmEnabled:r.irmEnabled,SupportsDecryptedContentDownload:r.supportsDecryptedContentDownload,FileName:e.file.name,SessionContext:e.sessionContext,WdParams:o,DocumentURL:window.location.href,PreviousSessionID:I("PreviousSessionID"),FirstPageFlushTime:null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:a.hostPageFirstFlushTime,BootJsStartTime:window.WOPIPerf_BootJsStartTime,BootJsEndTime:window.WOPIPerf_BootJsEndTime,InitializeWacTime:window.WOPIPerf_InitializeWac,UserClickTime:null!==(i=window.WOPIPerf_UserClick)&&void 0!==i?i:a.userClickTime,UnifiedUiHostDiagnostics:a.unifiedUiHostDiagnostics,ClientDiagnostics:e.clientDiagnostics};if(s.wacToken&&(c.WacToken=s.wacToken),e.hostSessionId){var d=e.hostSessionId.indexOf(".");c.HostSessionId=d>0?e.hostSessionId.substring(0,d):e.hostSessionId}if(a.legacyPerformanceData){var u=a.legacyPerformanceData.host;u&&(void 0!==u.timing.navigationStart&&(c.NavigationStart=u.timing.navigationStart),void 0!==u.timing.fetchStart&&(c.FetchStart=u.timing.fetchStart),void 0!==u.timing.requestStart&&(c.RequestStart=u.timing.requestStart),void 0!==u.timing.responseStart&&(c.ResponseStart=u.timing.responseStart),void 0!==u.timing.responseEnd&&(c.ResponseEnd=u.timing.responseEnd),void 0!==u.navigation.type&&(c.NavigationType=u.navigation.type),void 0!==u.navigation.redirectCount&&(c.NavigationRedirects=u.navigation.redirectCount))}else if(window.performance){var l=window.performance.timing;l&&(c.NavigationStart=l.navigationStart,c.FetchStart=l.fetchStart,c.RequestStart=l.requestStart,c.ResponseStart=l.responseStart,c.ResponseEnd=l.responseEnd);var f=window.performance.navigation;f&&(c.NavigationType=f.type,c.NavigationRedirects=f.redirectCount)}e.container.postMessage(ne.eo,c)}}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(si||(si={}));function Pi(e,t){var i=document.createElement("input");return i.type="hidden",i.name=e,i.value=t,i}var Ai,Ui=function(){function e(e){this.Rs=e}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return R()},e.prototype.GetSessionId=function(){return this.Rs},e.prototype.RegisterEventHandler=function(){},e.prototype.RemoveEventHandler=function(){},e.prototype.RegisterErrorHandler=function(){},e.prototype.RemoveErrorHandler=function(){},e.prototype.PostCommand=function(){},e.prototype.Dispose=function(){},e}();function Ei(e,t){var i;if(!e.IsFileNew){if(!e.WopiPrecheckInfo.FileGetUrl)throw Error("Missing FileGetUrl from contentParams");if(!e.WopiPrecheckInfo.FileName)throw Error("Null or Empty Filename")}var n=ti(e.OnDemandServer);if(!n)throw Error("Invalid Pods URL");var o,r,s=(o=e.OnDemandServer,(r=I("wdPopsUrl"))&&!T(r)&&(r=""),r||(r=(r=ti(o)).substr(0,r.indexOf("/pods/"))),"/"!==r.substr(r.length-1)&&(r+="/"),r);if(!s)throw Error("Invalid Pops URL");var a=fi(),c=pi(a),d="true"===I("wdEmbedView")||g(e.ApplicationUrl,"embed"),u=d?"pptembed.aspx":"ppt.aspx",l=be();t.ULS.Ge(51380293,A.H,U.Info,"IsRequestForMobileView:".concat(l));var f=n+(u=l?"pptmobileapp.aspx":u)+"?wdPodsUrl="+b(n)+"&wdPopsUrl="+b(s)+"&fastBoot=true&sw="+c.width+"&sh="+c.height+"&thPanel="+a.height+"&ro="+e.WopiPrecheckInfo.ReadOnly+"&sftc=1&NoAuth=1&jsApi=1&jsapiver=v1";e.WopiPrecheckInfo.FileName&&(f+="&fileName="+b(e.WopiPrecheckInfo.FileName)),"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||(f+="&readonly=1");var p=I("wdfs");p&&(f+="&fslide="+p);var v=I("wdfsection");if(v&&(f+="&fsection="+v),e.FeatureManager.isFeatureEnabled(J.Dt)||(null===(i=e.SettingsManager)||void 0===i?void 0:i.getValue(B.wt,!1))){var w=null===window||void 0===window?void 0:window._wopiContextJson;if(null==w?void 0:w.PredictedOfficeAppEndPointHintForRealSession){var m=null==w?void 0:w.PredictedOfficeAppEndPoint;if(m)if(e.SettingsManager.getValue(B._t,!1)){var C=null==w?void 0:w.PredictedOfficeAppEndPointAccessTime;if(C){var y=new Date(C);((new Date).getTime()-y.getTime()+3e5)/36e5<=e.SettingsManager.getValue(B.bt,48)&&(f+="&wdwaccluster="+m)}}else f+="&wdwaccluster="+m}}var P=I("wdIncludeHostUrl");(p||v||P&&"false"!==P)&&(f=Qt(f,"frameURL",b(window.location.href))),f=function(e,t){var i=e,n=function(e){return e.SessionInformation.UiLocale?e.SessionInformation.UiLocale:S(e.ApplicationUrl,"ui")}(t);n&&(i=Qt(i,"ui",n));var o=function(e){return e.SessionInformation.DataLocale?e.SessionInformation.DataLocale:S(e.ApplicationUrl,"rs")}(t);o&&(i=Qt(i,"rs",o));var r=h(t.ApplicationUrl,"mscc");r&&(i=Qt(i,"mscc",r));var s=h(t.ApplicationUrl,"wdFR");s&&(i=Qt(i,"wdFR",s));var a=hi(t);a&&(i=Qt(i,"wdOrigin",b(a)));var c=mi(t.PostMessageToken);return t.PostMessageToken&&(i+="&postMessageToken="+c),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=Qt(i,"dchat","1")),function(e,t){var i=t.indexOf("?");if(-1===i)return e;for(var n=e,o=0,r=t.substring(i+1).split("&");o<r.length;o++){var s=r[o].split("=");if(""===h(e,s[0])){var a=Yt(s[0],s[1]);a&&(n+="&"+a)}}return n}(i,t.ApplicationUrl)}(f=ei(f),e),e.IsFileNew&&(f+="&new=1"),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileSize?f+="&fs="+e.NewFileTemplateSource.FileSize:e.WopiPrecheckInfo.FileSize&&(f+="&fs="+e.WopiPrecheckInfo.FileSize);var E,O=!(E=e.SessionInformation.HostSessionId)||E.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):E;e.SessionInformation.HostSessionId&&(f+="&hid="+O);var F=I("Automation");F&&(f+="&Automation="+F);var k=I("StartRehearsal");k&&(f+="&StartRehearsal="+k),d||(f+="&usid="+e.SessionId),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&(f+="&uiEmbed=1"),e.SessionInformation.SupportsAccessibilityLoop&&(f+="&accloop=1"),e.SessionInformation.IsSynthetic&&(f+="syn=1");var N=S(e.ApplicationUrl,"uih");N&&(f+="&uih="+N),e.SessionInformation.UiHostIntegrationType&&(f+="&uihit="+b(e.SessionInformation.UiHostIntegrationType)),"Microsoft Teams"===e.SessionInformation.HostName&&(f+="&fvo=1"),e.SessionInformation.MetaUiHostVersion&&(f+="&muv="+b(e.SessionInformation.MetaUiHostVersion)),e.SessionInformation.HighContrastMode&&(f+="&hcm="+b(e.SessionInformation.HighContrastMode));var W=I("nav");if(W||(W=h(e.ApplicationUrl,"actNavId")),W)try{var M=_(W),D=JSON.parse(M),x=D.sId;x&&(f=Qt(f,"wdSlideId",x),f=Qt(f,"DC","1"));var H=D.commentId;H&&"null"!==H&&(f=Qt(f,"wdCommentId",H));var L=D.openMode;L&&"null"!==L&&(f=Qt(f,"wdOpenMode",L))}catch(e){t.ULS.Ge(38580688,A.H,U.Error,"Failed to parse navigation ID: ".concat(W))}var V=e.Container;if(V){var G=document.createElement("iframe");G.id="WebApplicationFrame",G.name="wac_frame",G.title="Office Online Frame",G.frameBorder="0",G.style.top="0",G.style.bottom="0",G.style.left="0",G.style.right="0",G.style.height="100%",G.style.width="100%",G.style.minHeight="200px",G.style.minWidth="300px",G.style.position="absolute",G.setAttribute("allowfullscreen","true"),G.setAttribute("allowTransparency","true");var j="";if(we()===ce.Safari)j+="autoplay;",j+="microphone;",j+="camera;",j+="clipboard-read;",j+="clipboard-write;",j+="display-capture;";else{var z=n+" "+function(e,t){if(t)return t.split("/pods/s/")[0]+"/pods/s/";if(e){var i=$t(e);if(i)return i.WacCdnStaticServer;throw Error("Application url provided but region not in region allow list")}return zt}(e.ApplicationUrl,e.BootstrapperUrl)+";";j+="autoplay "+z,j+="microphone "+z,j+="camera "+z,j+="clipboard-read "+z,j+="clipboard-write "+z,j+="display-capture "+z}G.setAttribute("allow",j),V.style.top="0",V.style.bottom="0",V.style.left="0",V.style.right="0",V.style.height="100%",V.style.width="100%",V.style.minHeight="200px",V.style.minWidth="300px",V.appendChild(G);var q=Date.now(),K=e.WopiPrecheckInfo.FileGetUrl;t.ULS.Ge(38580689,A.H,U.Info,K?K.toString().length.toString():"null"),f+="&fileGetUrlBool="+!!K;var Z=document.createElement("form");if(Z.name="frameForm",Z.id="frameForm",Z.target="wac_frame",Z.action=f,Z.method="post",V.appendChild(Z),e.WopiInfo){var $=e.WopiInfo.WopiSrc;$&&Z.appendChild(Pi("WOPISrc",$));var X=e.WopiInfo.AccessToken;X&&Z.appendChild(Pi("access_token",b(X)));var Q=e.WopiInfo.AccessTokenExpiry;Q&&Z.appendChild(Pi("access_token_ttl",Q.getTime().toString()));var ee=e.WopiInfo.WacToken;ee&&Z.appendChild(Pi("wac_token",b(ee)))}var te=e.SessionInformation.SessionContext;if(te&&Z.appendChild(Pi("sc",te)),e.SessionInformation.WdParams){var ie=_i(e.SessionInformation.WdParams);ie&&Z.appendChild(Pi("wdparams",ie))}Z.appendChild(Pi("jsapiversionminor",20240421007..toString())),e.SessionInformation.HideViewerToolbar&&Z.appendChild(Pi("hvt","1")),K&&Z.appendChild(Pi("fileUrl",K));var ne=e.WopiPrecheckInfo.CustomFontCatalogUrl;ne&&Z.appendChild(Pi("customFontCatalogUrl",ne)),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileGetUrl&&Z.appendChild(Pi("templateUrl",e.NewFileTemplateSource.FileGetUrl)),e.SessionInformation.UserId&&(Z.appendChild(Pi("UserID",e.SessionInformation.UserId)),Z.appendChild(Pi("user_id",e.SessionInformation.UserId))),e.WopiPrecheckInfo.IrmEnabled&&Z.appendChild(Pi("irmEnabled",e.WopiPrecheckInfo.IrmEnabled.toString())),e.WopiPrecheckInfo.SupportsDecryptedContentDownload&&Z.appendChild(Pi("SupportsDecryptedContentDownload",e.WopiPrecheckInfo.SupportsDecryptedContentDownload.toString())),e.WopiPrecheckInfo.ViewOnly&&Z.appendChild(Pi("ViewOnly",e.WopiPrecheckInfo.ViewOnly.toString())),e.NewFileTemplateSource&&e.NewFileTemplateSource.ETag?Z.appendChild(Pi("ETag",e.NewFileTemplateSource.ETag)):e.WopiPrecheckInfo.ETag&&Z.appendChild(Pi("ETag",e.WopiPrecheckInfo.ETag)),e.WopiPrecheckInfo.CTag&&Z.appendChild(Pi("RevID",e.WopiPrecheckInfo.CTag)),e.NewFileTemplateSource&&e.NewFileTemplateSource.DocUniqueId?Z.appendChild(Pi("DocID",e.NewFileTemplateSource.DocUniqueId)):e.WopiPrecheckInfo.DocUniqueId&&Z.appendChild(Pi("DocID",e.WopiPrecheckInfo.DocUniqueId)),e.WopiPrecheckInfo.BundleInfo&&e.WopiPrecheckInfo.BundleInfo.Url&&Z.appendChild(Pi("bundleUrl",e.WopiPrecheckInfo.BundleInfo.Url)),e.WopiPrecheckInfo.PreseededSessionKey&&!d&&Z.appendChild(Pi("PreseededSessionKey",e.WopiPrecheckInfo.PreseededSessionKey)),e.SessionInformation.HostName&&Z.appendChild(Pi("fileSrc",e.SessionInformation.HostName)),e.ApplicationCustomSettings&&e.ApplicationCustomSettings.HostUIControls&&Z.appendChild(Pi("huictrls",JSON.stringify(e.ApplicationCustomSettings.HostUIControls))),Z.appendChild(Pi("feature_status",Y(e.FeatureManager,{wdFlights:I("wdFlights")}))),me()&&Z.appendChild(Pi("touchDevice","1")),window.document.documentElement&&(void 0!==window.document.documentElement.clientWidth&&Z.appendChild(Pi("windowWidth",window.document.documentElement.clientWidth.toString())),void 0!==window.document.documentElement.clientHeight&&Z.appendChild(Pi("windowHeight",window.document.documentElement.clientHeight.toString())));var oe=I("PreviousSessionID");if(oe&&Z.appendChild(Pi("PreviousSessionID",oe)),Ee()&&Z.appendChild(Pi("LSSupported","1")),Z.appendChild(Pi("postMessageToken",e.PostMessageToken)),(e.SessionInformation.HideHeader||"teams"===N&&"UnifiedUiHostTeams"!==e.SessionInformation.UiHostIntegrationType&&"TeamsModern"!==e.SessionInformation.UiHostIntegrationType||"owa"===N||"DocGen"===e.SessionInformation.ContentAssemblyMode||"Templatization"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.SessionInformation.ContentAssemblyMode)&&Z.appendChild(Pi("hhdr","1")),e.SessionInformation.HideAppLauncherInHeader&&Z.appendChild(Pi("halh","1")),e.SessionInformation.HideSearchInHeader&&Z.appendChild(Pi("hsh","1")),e.SessionInformation.HideMeInHeader&&Z.appendChild(Pi("hmh","1")),e.SessionInformation.HideChatInHeader&&Z.appendChild(Pi("hch","1")),e.SessionInformation.HideWorkflowInHeader&&Z.appendChild(Pi("hwfh","1")),e.SessionInformation.HideSettingsInHeader&&Z.appendChild(Pi("hsth","1")),e.SessionInformation.ShowAppIconInHeader&&Z.appendChild(Pi("sih","1")),e.SessionInformation.UseNeutralColorInHeader&&Z.appendChild(Pi("unh","1")),e.SessionInformation.SupportsAuthToken&&Z.appendChild(Pi("sat","1")),e.SessionInformation.SupportsCustomAuthConfig&&Z.appendChild(Pi("cac","1")),e.SessionInformation.SupportsCreateNewDocument&&Z.appendChild(Pi("scnd","1")),e.SessionInformation.UseDarkTheme&&Z.appendChild(Pi("udt","1")),e.SessionInformation.SupportsDirectPrint&&Z.appendChild(Pi("sdp","1")),e.SessionInformation.SupportsDirectDownload&&Z.appendChild(Pi("sdd","1")),"Templatization"!==e.SessionInformation.ContentAssemblyMode&&"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||Z.appendChild(Pi("caae","1")),e.SessionInformation.ContentAssemblyMode&&Z.appendChild(Pi("caaemode",e.SessionInformation.ContentAssemblyMode)),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&e.SessionInformation.SupportsDocReboot&&Z.appendChild(Pi("sdr",!0===e.SessionInformation.SupportsDocReboot?"1":e.SessionInformation.SupportsDocReboot.toString())),e.SessionInformation.HideWACOneDriveFileLocationPicker&&Z.appendChild(Pi("hodflp","1")),e.SessionInformation.SupportsAtMentions&&Z.appendChild(Pi("sams","1")),e.WopiPrecheckInfo.RequestedCallThrottling){var re=e.WopiPrecheckInfo.RequestedCallThrottling;Z.appendChild(Pi("rct",re))}if(e.WopiPrecheckInfo.ClientThrottlingProtection){var se=e.WopiPrecheckInfo.ClientThrottlingProtection;Z.appendChild(Pi("ctp",se))}e.WopiPrecheckInfo.OpenViewByDefault&&Z.appendChild(Pi("ovbd",e.WopiPrecheckInfo.OpenViewByDefault.toString())),e.SessionInformation.SupportsMoveToFolder&&Z.appendChild(Pi("mtf","1")),e.SessionInformation.NoBrowserModalDialogs&&Z.appendChild(Pi("nbmd","1")),e.SessionInformation.SupportsCommonFilePicker&&Z.appendChild(Pi("sfp","1")),e.SessionInformation.OpenLinksInNewWindow&&Z.appendChild(Pi("onw","1"));var ae=ci(V);ae&&ae.isInHighContrastMode&&(Z.appendChild(Pi("IsInHighContrastMode","true")),ae.highContrastColors&&Z.appendChild(Pi("ClientColorSettings",ae.highContrastColors.foregroundTextColor+"_"+ae.highContrastColors.backgroundColor+"_"+ae.highContrastColors.linkColor)));var de=e.SessionInformation.OwlVersion;de&&Z.appendChild(Pi("owlver",de));var ue=e.SessionInformation.OwlRollout;return ue&&Z.appendChild(Pi("owlro",ue)),Z.appendChild(Pi("jsapibuild",R())),Z.submit(),{IFrameElement:G,FrameCreateTime:q}}}function Oi(e){var t=e.appContext,i="";if(we()===ce.Safari)i+="autoplay;microphone;camera;clipboard-read;clipboard-write;display-capture;";else{var n=t.podsUrl+" "+t.cdnBasePath+";";i+="autoplay "+n,i+="microphone "+n,i+="camera "+n,i+="clipboard-read "+n,i+="clipboard-write "+n,i+="display-capture "+n}return{permissionsPolicy:i,minHeight:t.shouldUsePods?"200px":"150px",minWidth:"300px",useAdditionalDiv:!t.shouldUsePods}}function Fi(e,t){return function(e,t){return e+"RemoteTelemetry.ashx"+(t?"?usid="+t:"")}(function(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}(e),t)}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Ai||(Ai={}));var ki={errorType:Ai.AppInitError,errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:5,ErrorName:"TimeoutInitialize",EventType:13,ExtraInfo:"Initialization timeout"},Ni=function(e,t){var i=this;if(this.Ws=0,this.Ms=0,this.Ds=0,this.xs=0,this.Bs=!1,this.Hs=function(e,t){i.Ws=D();var n=6e5,o=I("wdOnSuccessTimeout");o&&parseInt(o,10).toString()===o&&(n=parseInt(o,10),t.ULS.Ge(527521921,A.H,U.Warning,"App Timeout is overridden with url override param wdOnSuccessTimeout: ".concat(n))),n&&window.setTimeout((function(){return i.Ls(e,t)}),n)},this.Vs=function(e,t,n,o){var r={Message:"Received ".concat(e," callback after timeout had elapsed"),timeoutTimeMs:i.xs,successTimeMs:i.Ms,startTimeMs:i.Ws,appInitDiagnostics:n,error:o};t&&t.ULS.Ge(38589660,A.H,U.Info,JSON.stringify(r))},this.Ls=function(e,t){if(!(i.Ds||i.Ms||i.xs)){i.xs=D();try{if(ze(e.Container)){if(t){var n="Timed out waiting for FnOnInitializeSuccess to be called. startMs:".concat(i.Ws,", timeoutMs:").concat(i.xs,", scenario:Unified, hostSessionId:").concat(e.SessionInformation.HostSessionId,", host: ").concat(e.SessionInformation.HostName);t.ULS.Ge(38589661,A.H,U.Error,n),Ri(e,5,"TimeoutInitialize",n,t,i.xs,!0)}e.FnOnInitializeFailure&&e.FnOnInitializeFailure(ki)}else t&&(t.ULS.Ge(579604899,A.H,U.Warning,"App container is unloaded. Scenario: Unified"),Ri(e,7,"AppContainerUnloadedTimeout","App container is unloaded",t,i.xs,!1))}catch(e){t&&t.ULS.Ge(579604898,A.H,U.Error,"timeoutIfSuccessNotCalled exception: "+X(e))}}},e.FnOnInitializeSuccess){var n=e.FnOnInitializeSuccess;e.FnOnInitializeSuccess=function(o,r){i.Ms=D(),i.Bs||(i.Bs=!0,i.xs?i.Vs("success",t,r):(t&&(t.ULS.Ge(38836226,A.H,U.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),Ri(e,void 0,void 0,void 0,t,D(),!1,r)),n(o,r)))}}if(e.FnOnInitializeFailure){var o=e.FnOnInitializeFailure;e.FnOnInitializeFailure=function(n,r){i.Ds=D(),i.Bs||(i.Bs=!0,i.xs&&n!==ki?i.Vs("failure",t,r,n):(t&&(Ri(e,n.Code,n.ErrorName,n.errorObject,t,D(),!1,r),t.ULS.Ge(38836227,A.H,U.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")),o(n,r)))}}this.Hs(e,t)};function Ri(e,t,i,n,o,r,s,a){var c=null==t&&null==i&&null==n&&!s,d=e.SessionInformation,u=e.WopiPrecheckInfo,l=u.BundleInfo,f=0;null!=d.DocumentClickTime&&d.DocumentClickTime.getTime&&(f=d.DocumentClickTime.getTime());var p={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:u.FileSize,ApiStartTime:0,HostInitTime:d.HostInitTime,AppVersion:"1.20240421007",UseBabylon:"",EntryPoint:hi(e),SessionId:e.SessionId,UserAgent:window.navigator.userAgent,WACRegion:C(e.ApplicationUrl),FileHost:Si(d.HostName),Host:d.HostName,PodsRing:"",UiHost:gi(d.HostName)},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:f,BootSuccess:c,BootTime:r,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!u.FileGetUrl,FileNameBool:!!u.FileName,ReadOnly:u.ReadOnly,SupportsDecryptedContentDownload:u.SupportsDecryptedContentDownload,ViewOnly:u.ViewOnly,PreseededSessionKey:u.PreseededSessionKey,BundleInfo:l?{MajorVersion:l.MajorVersion,URLBool:!!l.Url}:""},AppBootTimings:a?a.appBootTimingDict:""};o.ULS.Ge(s?592007955:587843200,A.H,s?U.Error:U.Info,JSON.stringify(p)),W(Fi(e.ApplicationUrl,e.SessionId),"PowerPoint",c?"bootSuccess":"bootFailure")}function Wi(e){var t=6e5,i=e.wdParams.wdonsuccesstimeout;return i&&parseInt(i,10).toString()===i&&(t=parseInt(i,10)),t}function Mi(e){e.appContext.bootComplete=!0,Di(e),e.logger.ULS.Ge(34932955,A.H,U.Warning,JSON.stringify(e.diagnostics)),xi(e)}function Di(e){if(e.appContext.shouldUsePods){var t=e.appInitDiagnostics;t.officeFrameServerDocumentFlushTime=t.documentFlushTime,t.officeFrameServerFirstFlushTime=t.serverFirstFlushTime,t.officeFrameServerStartTime=t.serverStartTime,t.officeServerDocumentProcessStartTime=t.bootStartMs,t.officeServerDocumentProcessEndTime=t.bootEndMs,t.fileRequestsData=[{browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest",correlationId:t.downloadCorrelation,startTime:t.downloadStartMs,endTime:t.downloadEndMs,size:t.downloadSize,incremental:t.incDownload}],delete t.documentFlushTime,delete t.serverFirstFlushTime,delete t.serverStartTime,delete t.bootStartMs,delete t.bootEndMs,delete t.downloadCorrelation,delete t.downloadStartMs,delete t.downloadEndMs,delete t.downloadSize,delete t.incDownload}}function xi(e,t,i,n){var o=e.appContext;if(!o.bootRecorded){o.bootRecorded=!0;var r=void 0!==t||void 0!==i||void 0!==n,s=!!e.timeoutTime,a=!!e.failureTime,c=!(!e.successTime||s||a||r),d=c?e.successTime:a?e.failureTime:e.timeoutTime,u=e.file,l=e.hostInitDiagnostics,f=e.bootParams,p=e.contentBundle,h=e.preseededSession,v=e.appInitDiagnostics,w={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:u.size,ApiStartTime:0,HostInitTime:l.hostInitializeCallTime,AppVersion:"1.20240421007",UseBabylon:"",EntryPoint:l.entryPoint,SessionId:e.sessionId,UserAgent:window.navigator.userAgent,WACRegion:C(e.appBasePath),FileHost:e.host.storageHostName,Host:e.hostName,PodsRing:"",UiHost:e.host.uiHostName},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:l.userClickTime,BootSuccess:c,BootTime:d,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!u.getUrl,FileNameBool:!!u.name,ReadOnly:f.readOnly,SupportsDecryptedContentDownload:f.supportsDecryptedContentDownload,ViewOnly:f.viewOnly,PreseededSessionKey:h?h.key:void 0,BundleInfo:p?{MajorVersion:p.majorVersion,URLBool:!!p.url}:""},AppBootTimings:v?v.appBootTimingDict:""};e.logger.ULS.Ge(s?592007955:587843200,A.H,s?U.Error:U.Info,JSON.stringify(w))}}function Bi(e,t){xi(e,void 0,t.errorType,X(t.errorObject))}function Hi(e){try{var t=!e.container||!ze(e.container.element),i=t?7:5,n=t?"AppContainerUnloadedTimeout":"TimeoutInitialize",o=t?"App container is unloaded":"Timed out waiting for boot success. startMs:".concat(e.hostInitDiagnostics.hostInitializeCallTime,", timeoutMs:").concat(e.timeoutTime,", scenario:Unified, hostSessionId:").concat(e.hostSessionId,", host: ").concat(e.hostName);if(t)e.failureTime=e.timeoutTime,e.timeoutTime=0;else if(e.appContext.shouldUsePods){var r=function(t,i){Ce(e.appInitDiagnostics,i.Diagnostics),Di(e);var n=j({message:"Received success message after timeout had elapsed",timeoutTime:e.timeoutTime,currentTime:D()},e.diagnostics);e.logger.ULS.Ge(558195677,A.H,U.Info,JSON.stringify(n)),e.removeActionHandler(ie.ri,r)};e.addActionHandler(ie.ri,r)}xi(e,i,n,o)}catch(t){e.logger.ULS.Ge(558893250,A.H,U.Error,"onTimeout exception: "+X(t))}}function Li(e,t){xi(e,void 0,"AppInitError",X(t))}function Vi(){return!1}function Ji(e){e.appContext.shouldUsePods&&yi(e)}var Gi=function(e,t,i,n,o){return e!==ie.Bi?Promise.reject("Wrong flow"):i.ui.uiEmbed?function(e,t,i,n,o){return e!==ie.Bi?Promise.reject("Wrong flow"):new Promise((function(e){i.pendingReboot=!0;var n=void 0;if(t.queryOverrides)try{n=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.Ge(592217694,A.H,U.Error,"Failed to parse queryOverrides: ".concat(n))}i.raiseEvent(oe.Reboot,j(j({},t),{previousSessionId:i.sessionId,queryOverrides:n})),e({completion:"success"})}))}(e,t,i):new Promise((function(e){var n=window.location.href;g(n,"wdccsoff")&&(n=w(n,"wdccsoff")),n=v(n,"previoussessionid",i.sessionId,!0),t.controllerServicesParam&&(n=v(n,t.controllerServicesParamName,t.controllerServicesParam)),i.logger.ULS.Ge(560740507,A.H,U.Info,"Updating window.location.href"),window.location.href=n,e({completion:"success"})}))};function ji(e,t,i){if(void 0===i&&(i=!1),!e)throw new TypeError("SessionBootParams");var n=e.appUrl,o=e.appBaseUrl;if(!n&&!o)throw new TypeError("Either appUrl or appBaseUrl should exist");if(n&&"string"!=typeof n)throw new TypeError("AppUrl");if(o&&"string"!=typeof o)throw new TypeError("AppBaseUrl");var r=e.file;if(!r||!i&&!r.name)throw new TypeError("FileInfo");var s=e.container;if(!s||!(s instanceof qe)&&!s.appendChild)throw new TypeError("Container");if(!t&&!$e(e.wopi))throw new TypeError("WopiInfo")}var zi=function(){function e(e,t,i,n,o){this.Js=0,this.Gs=[],this.dr=!1,this.dr=e,this.js=t,this.Jt=i,this.zs=n,this.qs=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.js.getValue(B.it,!1);this.Js=M()+(this.qs?this.qs:this.js.getValue(B.$e,6e5));var i=this.dr?3e3:5e3;this.Ks=window.setInterval((function(){t&&e.Jt.ULS.Ge(595724178,A.H,U.Info,"Boot_HeartBeat"),M()>e.Js&&(e.stop(),qi(e.Jt),e.zs&&e.zs())}),this.js.getValue(B.tt,i)),this.Gs.push(window.setTimeout(qi,this.js.getValue(B.Xe,6e4),this.Jt,1)),this.Gs.push(window.setTimeout(qi,this.js.getValue(B.Qe,18e4),this.Jt,2))},e.prototype.stop=function(){this.Js=0,this.Ks&&(window.clearInterval(this.Ks),this.Ks=void 0),this.Gs.forEach((function(e){window.clearTimeout(e)})),this.Gs=[]},e}();function qi(e,t){e.ULS.Ge(594901218,A.H,U.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}var Ki,Zi=function(e,t,i,n,o){var s,u,f,p,v;if(e!==te.boot)return Promise.reject("Wrong flow");var w=t.appBaseUrl?t.appBaseUrl.toLowerCase():d(t.appUrl).toLowerCase();t.appUrl&&(w=c(w,h(t.appUrl,"region")));var I,b=qt[w];I=b?b.PodsUrl:w+"/pods/",i.je.updateEnvironment(I);var _=i.je.getValue(B.ct,!1),T=i.je.getValue(B.It,100),C=_&&T>window.crypto.getRandomValues(new Uint8Array(1))[0]%100,y=i.je.getValue(B.dt,!1),E=i.je.getValue(B.lt,!1),O=g((t.appUrl||"").toLowerCase(),"wdhostscenario","oneuplightspeed")?y:C,F=i.je.getValue(B.ut,!1);"public"===a((t.appUrl||"").toLowerCase())&&(O=F);var k,N=k=g(t.appUrl||"","embed","1")&&g(t.appUrl||"","PowerPointView","ChromelessView")||void 0!==t.intent&&-1!==t.intent.indexOf("embed")||"interactivepreview"===t.intent?"embed":(null===(s=i.bootParams)||void 0===s?void 0:s.viewOnly)||(null===(u=i.bootParams)||void 0===u?void 0:u.openViewByDefault)&&"default"===(null!==(f=t.intent)&&void 0!==f?f:"default")||"view"===t.intent?"reading":"editor";E||"reading"!==N||(N="embed");var M="editor"===k||"embed"===k&&!O;M&&(N="editor");var x="embed"===k?i.je.getValue(B.gt,"{}"):"reading"===k?i.je.getValue(B.St,"{}"):"{}";return i.logger.ULS.Ge(507863259,A.H,U.Info,JSON.stringify({requestedUiType:k,actualUiType:N,modernEmbedEnabled:O,modernReadingEnabled:E,intent:t.intent,uiEmbed:i.ui.uiEmbed,viewOnly:null===(p=i.bootParams)||void 0===p?void 0:p.viewOnly,openViewByDefault:null===(v=i.bootParams)||void 0===v?void 0:v.openViewByDefault,featureGates:x})),M?function(e,t,i,n,o){return e!==te.boot?Promise.reject("Wrong flow"):new Promise((function(e){var s,a=D();if(i.state=P.Booting,i.pendingReboot=!1,ji(t,i.skipWopiValidation,i.skipFileNameCheck),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=Xe(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=j(j({},t.diagnostics),{hostInitializeCallTime:a}),i.je.getValue(B.rt,!1)&&Fe(i.hostInitDiagnostics),t.appUrl){var u=t.appUrl;i.appUrl=u;var f=i.bootParams;g(u,"new")&&(f.isNewFile=!0),f.dataLanguage||(p=S(u,"rs"))&&(f.dataLanguage=p);var p,v=i.ui;if(g(u,"uiembed")&&(v.uiEmbed=!0),v.language||(p=S(u,"ui"))&&(v.language=p),!i.hostInitDiagnostics.entryPoint){var w=S(u,"wdorigin");w&&(i.hostInitDiagnostics.entryPoint=w)}if(!i.host.uiHostName){var I=S(u,"uih");I&&(i.host.uiHostName=I)}}else i.appUrl="";i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():d(t.appUrl).toLowerCase(),i.appBaseUrl=c(i.appBaseUrl,h(i.appUrl,"region")),i.je.updateEnvironment(i.appBaseUrl),n.initializeAppContext(i,e,t),i.appBasePath=n.buildAppBasePath(i);var b=!1,_=i.preseededSession;i.appInfo.usePreseededSessionId&&_&&_.id&&(i.sessionId=_.id,b=!0);var T,C=!1,y=t.hostGeneratedSessionId;if(!b&&y&&(i.sessionId=y,C=!0),t.rebootOverride&&(b||C||(s=ue(),i.sessionId=s[0],T=s[1]),i.pageStateObserver=new ke(i.logger,!0),i.authTokenTrustValidator=new We(i.logger)),i.logger.ULS.Ge(38580693,A.H,U.Info,"User session id: ".concat(i.sessionId,", is preseeded: ").concat(b,", is host generated: ").concat(C)),i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),W(i.remoteTelemetryUrl,i.appInfo.name,"init"),!i.isLoggerFromOwl){var E=i.je.getValue(B.Ze,"").toString();E||(E=l(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:E,sessionId:i.sessionId})}if(i.je.initializePeriodicFetch(i.appBasePath,i.sessionId),T&&i.logger.ULS.Ge(590966790,A.H,U.Info,JSON.stringify(T)),Ue(i),n.onContextReady&&n.onContextReady(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:R(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var O=t.container;i.container=O instanceof qe?O:i.application.createContainer(O)}i.container.setMessageHandler(i.onMessage);var F=!!n.ignoreCompletionMessage&&n.ignoreCompletionMessage(i),k=function(e,t){i.successTime=D(),F||(i.container.postMessage(ne.Qn,void 0),Ce(i.appInitDiagnostics,t.Diagnostics)),i.je.addSettingsChangeListener(i.logger.settingsChangeHandler),n.onSuccess&&n.onSuccess(i,t),i.logger.ULS.Ge(596448985,A.H,U.Info,JSON.stringify(i.diagnostics)),W(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(ne.ro,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=P.Booted,M({completion:"success"}),ye(i.appInfo.name,i.logger)},N=function(e,t){var o;i.failureTime=D(),n.onFailure&&n.onFailure(i,t.Error),i.logger.ULS.Ge(596448986,A.H,U.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),W(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=P.Failed,M({completion:"failure",error:t.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(o=i.appInitDiagnostics)||void 0===o?void 0:o.documentLoadedWithTabSwitch}),ye(i.appInfo.name,i.logger)},M=function(t){F||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(ie.ri,k),i.removeActionHandler(ie.ni,N)),e(t)};o&&o.subscribe((function(){var e;M({completion:o.reason||"cancelled",documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch})})),F||(i.addActionHandler(ie.ri,k),i.addActionHandler(ie.ni,N)),function(e){var t;if(function(e){return"wdjs"in e||"wd1js"in e}(e))"true"===window.sessionStorage.getItem("sideLoadingIsEnabled")?(!1,"true"===(t=He("sideLoadingIsEnabled"))||"false"!==t&&!1||Le("sideLoadingIsEnabled","true",1)):Le("sideLoadingIsEnabled","false",0)}(i.wdParams);var x=n.buildBootRequestParams(i),H=Qe(i,x.appPageName,x.queryParamsOverrides),L=Ye(i,x.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(H,i.host.origin))try{n.beforePreload&&n.beforePreload(i);var V=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(J.At)&&(i.logger.ULS.Ge(590966791,A.H,U.Info,"HTTP2 preload enabled"),V=m(V)),i.preloader.preload(V,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.Ge(590966792,A.H,U.Error,"Error preloading")}n.beforeContainerBoot&&n.beforeContainerBoot(i,H),i.appInitDiagnostics.officeFrameCreateTime=D(),i.container.boot(H,L,i.logger,n.buildContainerBootParams(i)),F?k(ie.ri,{Diagnostics:{}}):(i.bootHeartBeat=new zi(r(i.appBaseUrl),i.je,i.logger,(function(){var e;i.timeoutTime=D(),n.onTimeout&&n.onTimeout(i),W(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),M({completion:"timeout",error:{documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch}}),o&&o.cancel()}),o&&n.overrideBootTimeout?Math.min(o.timeoutInMs,n.overrideBootTimeout(i)):o?o.timeoutInMs:n.overrideBootTimeout?n.overrideBootTimeout(i):void 0),n.beforeBootCompletionMessage&&n.beforeBootCompletionMessage(i))})).catch((function(e){throw i.failureTime=D(),n.onException&&n.onException(i,e),i.remoteTelemetryUrl&&W(i.remoteTelemetryUrl,i.application.name,"bootException"),i.bootHeartBeat&&i.bootHeartBeat.stop(),{error:e.toString(),errorStack:e.stack}}))}(e,t,i,n,o):new Promise((function(e){return z(void 0,void 0,void 0,(function(){var o,r,s,a,c,d,u,f,p,h,v,m,b,_,T,C,y,E,O,F,k,M,H,L,V,J,G,K,Z;return q(this,(function($){switch($.label){case 0:o=D(),i.state=P.Booting,i.pendingReboot=!1,ji(t,!0),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=Xe(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=j(j({},t.diagnostics),{hostInitializeCallTime:o}),i.je.getValue(B.ft,!0)&&(i.wdParams.wdForceModernSlideShowInTeams="true"),i.je.getValue(B.rt,!1)&&Fe(i.hostInitDiagnostics),t.appUrl?(r=t.appUrl,i.appUrl=r,s=i.bootParams,g(r,"new")&&(s.isNewFile=!0),s.dataLanguage||(c=S(r,"rs"))&&(s.dataLanguage=c),a=i.ui,g(r,"uiembed")&&(a.uiEmbed=!0),a.language||(c=S(r,"ui"))&&(a.language=c),i.hostInitDiagnostics.entryPoint||(d=S(r,"wdorigin"))&&(i.hostInitDiagnostics.entryPoint=d),i.host.uiHostName||(u=S(r,"uih"))&&(i.host.uiHostName=u)):i.appUrl="",i.appBaseUrl=w,i.appBasePath=I,i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),W(i.remoteTelemetryUrl,i.appInfo.name,"init"),""===(f=i.je.getValue(B.Ze,"").toString())&&(f=l(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:f,sessionId:i.sessionId}),i.je.initializePeriodicFetch(i.appBasePath,i.sessionId),Ue(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:R(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),p=function(t,n){i.failureTime=D(),i.logger.ULS.Ge(596448986,A.H,U.Error,JSON.stringify({diagnostics:i.diagnostics})),W(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=P.Failed,e({completion:"failure",error:j(j({},t),{errorSource:n})}),ye(i.appInfo.name,i.logger)},$.label=1;case 1:if($.trys.push([1,3,,4]),!i.bootstrapperUrl)throw new Error("No bootstrapperUrl");if(!(h=new URL(w).hostname).includes("powerpoint"))throw new Error("Invalid appBaseUrl");if(v=Kt[w],i.logger.ULS.Ge(507357262,A.H,U.Info,JSON.stringify({appBaseUrl:h,previewerRing:v})),!v)throw new Error("Unsupported region");return(m=new URL(i.bootstrapperUrl)).hostname=m.hostname.replace("wise.","res."),m.hostname=m.hostname.replace(".gcc.",".gcch."),m.pathname="/pptlive-m/5mttl/bootstrap/".concat(v,"/powerpoint.preview.boot.js"),[4,(X=m,z(void 0,void 0,void 0,(function(){return q(this,(function(e){return[2,new Promise((function(e,t){var i=document.createElement("script");i.src=X.href,i.async=!0,i.onload=function(){e()},i.onerror=function(e){t(e)},document.head.appendChild(i)}))]}))})))];case 2:return $.sent(),[3,4];case 3:return b=$.sent(),p(b,"JsApi"),[2];case 4:return(null===(E=null===(y=null===(C=null===(T=null===window||void 0===window?void 0:window.Microsoft)||void 0===T?void 0:T.Office)||void 0===C?void 0:C.PowerPoint)||void 0===y?void 0:y.Bootstrap)||void 0===E?void 0:E.InitializeWopiPending)?(_={ApplicationUrl:i.appUrl,Container:t.container,SessionInformation:{HostName:i.hostName,HostSessionId:i.hostSessionId,UserId:i.user.id,DocumentClickTime:null===(O=i.hostInitDiagnostics)||void 0===O?void 0:O.userClickTime,EntryPoint:null===(F=i.hostInitDiagnostics)||void 0===F?void 0:F.entryPoint,HostInitTime:(new Date).toISOString(),WdParams:i.wdParams,UiHostRing:null===(k=null==t?void 0:t.diagnostics)||void 0===k?void 0:k.teamsRing,PptFeatureGates:x},WopiPrecheckInfo:{FileName:i.file.name,FileGetUrl:i.file.getUrl,FileSize:i.file.size,ReadOnly:null===(M=i.bootParams)||void 0===M?void 0:M.readOnly,IrmEnabled:null===(H=i.bootParams)||void 0===H?void 0:H.irmEnabled,DocUniqueId:i.file.uniqueId,CTag:i.file.cTag,ETag:i.file.cTag,ViewOnly:null===(L=i.bootParams)||void 0===L?void 0:L.viewOnly},ApplicationCustomSettings:{ForceAccessibilityMode:!1,EnableWacFallback:!1,UseTransparentBackground:!1,UiType:N},Diagnostics:{entryPoint:null===(V=i.hostInitDiagnostics)||void 0===V?void 0:V.entryPoint,userClickTime:null===(J=i.hostInitDiagnostics)||void 0===J?void 0:J.userClickTime,hostPageFirstFlushTime:null===(G=i.hostInitDiagnostics)||void 0===G?void 0:G.hostPageFirstFlushTime,officeBootstrapperStartTime:null===(K=i.hostInitDiagnostics)||void 0===K?void 0:K.officeBootstrapperStartTime,officeBootstrapperEndTime:null===(Z=i.hostInitDiagnostics)||void 0===Z?void 0:Z.officeBootstrapperEndTime},FnOnInitializeSuccess:function(){i.successTime=D(),i.logger.ULS.Ge(596448985,A.H,U.Info,JSON.stringify(i.diagnostics)),W(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),ye(i.appInfo.name,i.logger),i.state=P.Booted,e({completion:"success"})},FnOnInitializeFailure:function(e){p(e,"App")}},window.Microsoft.Office.PowerPoint.Bootstrap.InitializeWopiPending(_).Complete(),[2]):(p(new Error("InitializeWopiPending not found"),"JsApi"),[2])}var X}))}))}))},$i=function(e,t,i,n,o){return e!==ie.tn?Promise.reject("Wrong flow"):new Promise((function(e){var n=i.appContext;"FatalError"===t.Reason?function(e,t){var i=e.hostInitDiagnostics,n={ErrorName:t,BootCompleted:e.appContext.bootComplete,SessionInfo:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:e.bootParams.dataLanguage,DocumentClickTime:i.userClickTime,HostInitTime:i.hostInitializeCallTime,UiHost:e.host.uiHostName,WdParams:e.wdParams}};e.logger.ULS.Ge(587236555,A.H,U.Error,JSON.stringify(n))}(i,t.ErrorName):i.logger.ULS.Ge(558421913,A.H,U.Info,"Updating boot complete - reason [".concat(t.Reason,"]")),n.bootComplete||(i.bootHeartBeat&&i.bootHeartBeat.stop(),n.bootFlowResolve({completion:"success"})),i.successTime=D(),xi(i),e({completion:"success"})}))},Xi=function(){var e,t;return[(e={},e[ee.appReboot]=Gi,e[ee.boot]=Zi,e[ee.closeTab]=Ze,e[ee.createNew]=et,e[ee.dispose]=rt,e[ee.frameTrust]=st,e[ee.getAuthToken]=at,e[ee.getHostKeyValue]=Ze,e[ee.handleBootState]=ct,e[ee.postWacToken]=dt,e[ee.rename]=ut,e[ee.setOverlayContent]=lt,e[ee.setWacFlightValue]=ft,e[ee.storeHostKeyValue]=Ze,e[ee.switchMode]=Ze,e[ee.updateBootComplete]=$i,e),(t={},t[ee.boot]={initializeAppContext:ii,buildAppBasePath:ni,buildRemoteTelemetryUrl:oi,ignoreCompletionMessage:ri,buildBootRequestParams:Ti,beforeContainerBoot:Ci,buildContainerBootParams:Oi,overrideBootTimeout:Wi,onSuccess:Mi,onFailure:Bi,onTimeout:Hi,onException:Li},t[ee.createNew]={parallelizeStartSessionRequest:Vi,sendCreateNewWopiInfo:Ji},t)]};!function(e){e[e.AppPageLoading=0]="AppPageLoading",e[e.AppReadyForPostMessage=1]="AppReadyForPostMessage",e[e.AppBootComplete=2]="AppBootComplete",e[e.DEPRECATED=3]="DEPRECATED",e[e.RefreshPage=4]="RefreshPage",e[e.UpdateInitializationComplete=6]="UpdateInitializationComplete",e[e.ProfileClientResourceUsage=7]="ProfileClientResourceUsage",e[e.ULSLog=8]="ULSLog"}(Ki||(Ki={}));var Qi=function(){function e(){var t=this;this.Zs={},this.$s=function(e,i){for(var n in t.Zs){var o=t.Zs[n];o&&o.log(e,i)}},this.Xs=function(t){var i;try{i=JSON.parse(t.data)}catch(e){i=null}if(i){var n=i.m_id||i.Token;if(n){var o=e.getInstance(),r=o.get(n);r?r.onMessage(i,t.source):o.$s("Message received with no targetApi. Id: "+n.toString(),t.data)}}},window.addEventListener("message",this.Xs)}return e.getInstance=function(){return this.Qs||(this.Qs=new e),this.Qs},e.prototype.add=function(e,t){this.Zs[e]=t},e.prototype.get=function(e){return this.Zs[e]},e.prototype.remove=function(e){this.Zs[e]=null},e}();function Yi(e,t,i,n){return{ShouldUsePODS:e,CanUsePODS:t,Reason:i,CreateNewScenario:n}}function en(e,t){var i,n,o=e.WopiPrecheckInfo,r=e.ApplicationUrl,s=function(e,t,i,n){var o,r;e.CreateNewInfo?(r=ot.UnifiedCreateNew,o="CreateNewInfo"):e.IsNewFile?(r=ot.UnifiedCreateNew,o="CreateNewInfoIsNewFile"):e.IsNewFileFromHostTemplate?(r=ot.UnifiedCreateNew,o="CreateNewInfoFromHostTemplate"):i&&i.FileGetUrl?(r=ot.UnifiedCreateNew,o="CreateNewInfoFromTemplateSourceUrl"):g(t,"new")?0!==e.FileSize?(r=ot.LegacyCreateNew,o="ApplicationUrlContainsNewAndNonZeroByteFile"):(r=ot.UnifiedCreateNew,o="ApplicationUrlContainsNew"):(r=ot.NotCreateNew,o="NotCreateNew");var s={};return s.CreateNewScenario=ot[r],s.reason=o,n.ULS.Ge(34932951,A.H,U.Info,JSON.stringify(s)),r}(o,r,e.NewFileTemplateSource,t),a=I("wdPodsEnabled");return i=o.FileGetUrl,n=a?Yi("false"!==a,!0,"wdPodsEnabled is available",s):function(e,t,i){if($t(e))return t===ot.LegacyCreateNew?Yi(!1,!1,"Legacy Create New Scenario because application url contains new, but non-zero file size",t):-1!==e.indexOf("&Embed=1")?Yi(!1,!1,"Embed View fallback to WAC",t):Yi(!0,!0,"Supported Region",t);var n="Wac region not currently supported by PODS: "+(C(e)||"");return i.ULS.Ge(589168768,A.H,U.Warning,n),Yi(!1,!1,n,t)}(r,s,t),i||n.CreateNewScenario!==ot.NotCreateNew?n:Yi(!1,!1,n.Reason+"| FileGetUrl is empty",n.CreateNewScenario)}var tn,nn,on=function(){function e(){var e=this;if(this.Ys=[],this.ea=[],this.ta=function(){var t={visibility:document.visibilityState,time:D(),initialState:!1};e.Ys.push(t);for(var i=0,n=e.ea;i<n.length;i++){var o=n[i];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:D(),initialState:!0};this.Ys.push(t)}document.addEventListener("visibilitychange",this.ta)}return e.prototype.registerEventHandler=function(e){this.ea.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.ea.indexOf(e);this.ea.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.ta)},e.prototype.getVisibilityChangeEvents=function(){return this.Ys},e.prototype.dispose=function(){this.stop(),this.ea=[],this.Ys=[]},e}(),rn=((tn={})[te.blurFocus]=ne.$n,tn[te.continueAccessibilityLoop]=ne.to,tn[te.grabFocus]=ne.io,tn[te.moveToFolder]=ne.ki,tn[te.popState]=ne.ao,tn[te.rename]=ne.wo,tn[te.sendAccessToken]=ne.mo,tn[te.sendAuthToken]=ne.So,tn[te.sendCustomAuthConfig]=ne.Io,tn[te.sendEmbeddedViewUrl]=ne._o,tn[te.sendSessionInfo]=ne.To,tn[te.sendUserAccessAndPermissions]=ne.Co,tn[te.sendWopiInfo]=ne.yo,tn[te.sendDavUrl]=ne.Po,tn[te.completeSharedFilePicker]=ne.Gi,tn[te.switchMode]=ne.ko,tn[te.signalShared]=ne.Mo,tn),sn=function(){function e(e,t){var i,n,o=this;if(this.ia=!1,this.ea={},this.ar="",this.cr="",this.lr=!1,this.dr=!1,this.ur=!1,this.pr=!1,this.na=[],this.oa=!0,this.ra=function(e,t,i){if(e){var n={MessageId:ne.qn,CorrelationId:i,SendTime:D()};o.Jt.ULS.Ge(595732176,A.H,U.Info,"Sending Ack back"),e.postMessage(JSON.stringify(n),t)}else o.Jt.ULS.Ge(595736136,A.H,U.Info,"Missing target to send Ack back")},this.sa=function(e){var t,i=!1,n=!0,r="",s=!1;if(o.aa&&o.aa.contentWindow&&(i=!0,n=e.source===o.aa.contentWindow),e.origin&&!(s=(r=u(e.origin,2).toLowerCase())===o.cr)&&o.wr&&(r=u(e.origin).toLowerCase(),s=o.wr.includes(r)),!o.dr&&(!o.ur||s&&n)||o.Jt.ULS.Ge(595730526,A.H,U.Info,"Window is available: ".concat(i,", window is valid: ").concat(n,", origin is valid: ").concat(s,", expected origin: ").concat(o.cr,", actual origin: ").concat(r)),s&&(!o.lr||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void o.Jt.ULS.Ge(596464282,A.H,U.Info,"Failed to parse event data: ".concat(X(e),"."))}var c=a.MessageId;if(c){if(o.Jt.ULS.Ge(595714715,A.H,U.Info,"Received messageId: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ie.ri&&c!==ie.Oi||o.ca(e.origin),o.pr&&c===ie.Ln)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);a.Values&&a.Values.ackExpected&&o.ra(e.source,e.origin,a.CorrelationId);var d=o.ea[c];if(!d)return o.Jt.ULS.Ge(596464289,A.H,U.Info,"No handler found for message id: ".concat(c)),void(o.oa&&c===ie.yi&&(o.na.push(a),o.Jt.ULS.Ge(543207888,A.H,U.Info,"Kept for later process: ".concat(c))));o.Jt.ULS.Ge(596464288,A.H,U.Info,"Processing message: ".concat(c)),c===ie.Ki&&(a.Values=j(j({},a.Values||{}),{sendTimeAsClickTime:a.SendTime}));try{d(a.Values||{})}catch(e){o.Jt.ULS.Ge(593773704,A.H,U.Error,"Handler error: ".concat(X(e)))}}else(o.dr||o.ur)&&o.Jt.ULS.Ge(595730520,A.H,U.Info,"Could not find message id")}},this.da=function(){o.oa=!1,o.na.forEach((function(e){var t=e.MessageId,i=o.ea[t];if(i){o.Jt.ULS.Ge(543207890,A.H,U.Info,"Processing message after boot complete: ".concat(t));try{i(e.Values||{})}catch(e){o.Jt.ULS.Ge(543207891,A.H,U.Error,"Handler error: ".concat(X(e)))}}else o.Jt.ULS.Ge(543207889,A.H,U.Info,"No handler found after boot complete: ".concat(t))})),o.na=[]},this.ua=function(e,t,i){e.postMessage(t,i)},this.ca=function(e){var t=e.toLowerCase();o.ar&&o.ar!==t&&o.Jt.ULS.Ge(596128131,A.H,U.Warning,"Updating origin: [".concat(C(o.ar),"]->[").concat(C(t),"]")),o.ar=t,o.cr=u(t,2),o.dr=r(t),o.ur=s(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.dr=r(e),this.ur=s(e),this.Jt=t,this.ca(e),this.pr=!!(null===(n=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===n?void 0:n.match(/wdpa=1/gi))||"1"===He("EnableMetricLogging")}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.ea[e])throw new Error("Duplicate registration!");this.ea[e]=t},e.prototype.removeMessageHandler=function(e){delete this.ea[e]},e.prototype.sendPostMessage=function(e,t,i){if(e&&e.contentWindow){this.Jt.ULS.Ge(596464334,A.H,U.Info,"Sending message: "+t);var n={MessageId:t,SendTime:D(),Values:i};this.ua(e.contentWindow,JSON.stringify(n),this.ar)}else this.Jt.ULS.Ge(595948308,A.H,U.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.aa=e,this.lr=!!t,this.ia||(window.addEventListener("message",this.sa,!1),this.ia=!0)},e.prototype.postMessageForCommand=function(e,t,i){var n=rn[t];n?(this.Jt.ULS.Ge(595702598,A.H,U.Info,"Sending message ".concat(n," for command ").concat(t)),this.sendPostMessage(e,n,i)):this.Jt.ULS.Ge(595702599,A.H,U.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.ea={},this.ia&&(window.removeEventListener("message",this.sa,!1),this.ia=!1)},e}();!function(e){e.BrowserEvent="BrowserEvent",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(nn||(nn={}));var an=!1,cn=!1;function dn(e){if(!an)try{an=!0,cn=!1,function(e){e.innerApplicationFrame&&(e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0))}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:D(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};if(e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime),e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime),e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,n=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-e.forceAppUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.Ge(595855436,A.H,U.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.Ge(595714434,A.H,U.Error,"Error disposing: ".concat(X(t)))}}var un,ln=function(e){function t(t,i,n,o,r){var s=e.call(this,t,i,n,o,r)||this;return s.la={},s.fa=!1,s.pa=!1,s.ha=function(){s.pa||(s.pa=!0,s.fa=!1,s.va&&s.va(),s.wa(nn.Unloaded,{}),s.wa(nn.Disposed,{}),s.la.disposeEndTime=D(),s.Jt.ULS.Ge(41710159,A.H,U.Info,JSON.stringify(s.la)),s.ea={})},s.ma=function(e){s.la.appUnloadEndTime=D(),e&&(s.la.wacDisposeTelemetry=e),s.ha()},s.ga=function(){!s.fa&&s.pa||(s.Jt.ULS.Ge(41710160,A.H,U.Warning,"Unload timed out"),s.la.appUnloadTimedOut=!0),s.ha()},s.Sa.registerMessagePayloadHandler(ie.Qi,s.ma),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}G(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(t,e),t.prototype.Dispose=function(e,t){if(!(this.pa||this.fa&&e))if(this.la.disposeStartTime=D(),e){this.fa=!0,this.la.appUnloadStartTime=D(),this.la.forceAppUnload=e,this.Sa.sendPostMessage(this.aa,ne.No,{});var i=t||1e3;window.setTimeout(this.ga,i)}else this.ha()},t}(function(){function e(e,t,i,n,o){var r=this;this.ea={},this.Ia=function(){r.Sa.registerMessagePayloadHandler(ie.Bi,r.ba),r.Sa.registerMessagePayloadHandler(ie.Ui,r._a),r.Sa.registerMessagePayloadHandler(ie.Ei,r.Ta),r.Sa.registerMessagePayloadHandler(ie.yi,r.Ca),r.Sa.registerMessagePayloadHandler(ie.Ki,r.ya),r.Sa.registerMessagePayloadHandler(ie.Pi,r.Pa),r.Sa.registerMessagePayloadHandler(ie.ki,r.Aa),r.Sa.registerMessagePayloadHandler(ie.Gi,r.Ua)},this.wa=function(e,t){var i=r.ea[e];if(i)try{i(t||{})}catch(e){r.Jt.ULS.Ge(593773706,A.H,U.Error,"Handler error: ".concat(X(e)))}},this.ba=function(e){e.previousSessionId=r.Rs,r.wa(nn.DocumentReboot,e)},this._a=function(e){r.wa(nn.WopiInfoFromUrl,e)},this.Ta=function(e){r.wa(nn.DavUrlFromIds,e)},this.Ca=function(e){Promise?r.Ea.isResourceTrustedForMessage(e).then((function(t){t?r.wa(nn.GetAuthToken,e):r.Sa.sendPostMessage(r.aa,ne.So,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){r.Sa.sendPostMessage(r.aa,ne.So,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):r.Sa.sendPostMessage(r.aa,ne.So,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.ya=function(e){r.wa(nn.FileShare,e)},this.Pa=function(e){r.wa(nn.GetCustomAuthConfig,e)},this.Aa=function(e){r.wa(nn.MoveToFolder,e)},this.Ua=function(e){r.wa(nn.SharedFilePicker,e)},this.Rs=e,this.Jt=t,this.aa=o.innerApplicationFrame,this.Sa=i,this.va=n,this.Ea=new We(t),this.Ia(),an=!1}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return R()},e.prototype.GetSessionId=function(){return this.Rs},e.prototype.RegisterEventHandler=function(e,t){switch(e){case nn.Unloaded:case nn.Disposed:case nn.DocumentReboot:case nn.WopiInfoFromUrl:case nn.DavUrlFromIds:case nn.GetAuthToken:case nn.GetCustomAuthConfig:case nn.MoveToFolder:case nn.SharedFilePicker:case nn.SetOverlayContent:case nn.FileShare:if(this.ea[e])throw new Error("Duplicate registration");this.ea[e]=t;break;default:this.Sa.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case nn.Unloaded:case nn.Disposed:case nn.DocumentReboot:case nn.FileShare:case nn.WopiInfoFromUrl:case nn.DavUrlFromIds:case nn.GetAuthToken:case nn.GetCustomAuthConfig:case nn.MoveToFolder:case nn.SharedFilePicker:case nn.SetOverlayContent:if(this.ea[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.ea[e];break;default:this.Sa.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.Sa.postMessageForCommand(this.aa,e,t)},e.prototype.Dispose=function(e,t){var i=this;!function(e,t,i,n,o,r,s){if(t.ULS.Ge(595714433,A.H,U.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(an,"; unloading:").concat(cn)),an||cn&&e)t.ULS.Ge(595714908,A.H,U.Info,"Application is already disposed or unloading");else{var a,c={logger:t,postMessenger:i,innerApplicationFrame:n,onDisposed:o,onFrameRemoved:r,unloadTimeoutInMs:s||1e3,forceAppUnload:!1,disposeStartTime:D(),appUnloadTimedOut:!1};if(e&&n)return cn=!0,c.forceAppUnload=!0,(a=c).forceAppUnloadStartTime=D(),a.logger.ULS.Ge(595855490,A.H,U.Info,"Sending postmessage to unload app"),a.logger.ULS.flush(),a.postMessenger.registerMessagePayloadHandler(ie.Qi,(function(e){return function(e,t){e.forceAppUnloadEndTime=D(),e.appUnloadedMessageValues=t,e.logger.ULS.Ge(595855491,A.H,U.Info,"AppUnloaded received from app"),dn(e)}(a,e)})),a.postMessenger.sendPostMessage(a.innerApplicationFrame,ne.No,{}),void window.setTimeout((function(){return function(e){!cn&&an||(e.appUnloadTimedOut=!0,e.logger.ULS.Ge(595855492,A.H,U.Info,"ApplicationUnload timed out, forcing dispose"),dn(e))}(a)}),a.unloadTimeoutInMs);dn(c)}}(e||!1,this.Jt,this.Sa,this.aa,(function(){delete i.aa,i.va(),i.Sa.dispose(),i.wa(nn.Unloaded,{})}),(function(){try{i.wa(nn.Disposed,{}),i.ea={}}catch(e){i.Jt.ULS.Ge(589108815,A.H,U.Error,"onFrameRemoved error: ".concat(X(e)))}}),t)},e}()),fn=function(){function e(){this.hasAppBooted=!1}return e.prototype.getIfAllFieldsSet=function(){if(this.wopiInfo&&this.hasAppBooted&&this.iframe&&this.podsUrl)return{wopiInfo:this.wopiInfo,iframe:this.iframe,podsUrl:this.podsUrl,readonly:this.readonly,hasAppBooted:this.hasAppBooted,irmEnabled:this.irmEnabled,supportsDecryptedContentDownload:this.supportsDecryptedContentDownload,fileName:this.fileName}},e}(),pn=function(){function e(e,t,i,n,o){var r,s=this;this.Oa=new fn,this.Fa=!1,this.ka=new on,this.Na=function(){var e=Qi.getInstance();e&&s.Ra&&e.remove(s.Ra.PptInitParams.PostMessageToken),s.Ss&&s.Ss.dispose(),s.Wa&&s.Wa.parentElement&&s.Wa.parentElement.removeChild(s.Wa),s.Wa&&delete s.Wa,s.Ma(),s.Jt.ULS.Ge(587552790,A.H,U.Warning,"PPTUnifiedSessionLoader::dispose:: App dispose"),s.ka.stop()},this.Da=function(){var e,t,i,n,o=s.Oa&&s.Oa.getIfAllFieldsSet();if(!s.xa&&o&&o.iframe.contentWindow){var r={};r.WopiSrc=o.wopiInfo.WopiSrc,r.AccessToken=o.wopiInfo.AccessToken,r.AccessTokenTTL=o.wopiInfo.AccessTokenExpiry?o.wopiInfo.AccessTokenExpiry.getTime():0,r.ReadOnly=o.readonly,r.IrmEnabled=o.irmEnabled,r.SupportsDecryptedContentDownload=o.supportsDecryptedContentDownload,r.FileName=o.fileName,r.SessionContext=s.Ba,r.WdParams=s.Ha,r.DocumentURL=window.location.href,o.wopiInfo.WacToken&&(r.WacToken=o.wopiInfo.WacToken);var a=I("PreviousSessionID");a&&(r.PreviousSessionID=a),(null===(i=null===(t=null===(e=s.Ra)||void 0===e?void 0:e.PptInitParams)||void 0===t?void 0:t.SessionInformation)||void 0===i?void 0:i.HostSessionId)&&(r.HostSessionId=null===(n=s.Ra)||void 0===n?void 0:n.PptInitParams.SessionInformation.HostSessionId),s.La(r),o.iframe.contentWindow.postMessage(JSON.stringify(r),o.podsUrl),s.xa=!0}},this.La=function(e){var t,i,n,o,r,a,c=null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:null===(n=null===(i=s.Ra)||void 0===i?void 0:i.AppInitDiagnostics)||void 0===n?void 0:n.hostPageFirstFlushTime;c&&(e.FirstPageFlushTime=c);var d=window.WOPIPerf_BootJsStartTime;d&&(e.BootJsStartTime=d);var u=window.WOPIPerf_BootJsEndTime;u&&(e.BootJsEndTime=u);var l=window.WOPIPerf_InitializeWac;l&&(e.InitializeWacTime=l);var f=window.WOPIPerf_UserClick,p=s.Ra&&s.Ra.AppInitDiagnostics&&s.Ra.AppInitDiagnostics.userClickTime;if(f?e.UserClickTime=f:p&&(e.UserClickTime=p),window.performance){var h=window.performance.timing;h&&(e.NavigationStart=h.navigationStart,e.FetchStart=h.fetchStart,e.RequestStart=h.requestStart,e.ResponseStart=h.responseStart,e.ResponseEnd=h.responseEnd);var v=window.performance.navigation;v&&(e.NavigationType=v.type,e.NavigationRedirects=v.redirectCount)}e.UnifiedUiHostDiagnostics=null===(r=null===(o=s.Ra)||void 0===o?void 0:o.AppInitDiagnostics)||void 0===r?void 0:r.unifiedUiHostDiagnostics,e.ClientDiagnostics=null===(a=s.Ra)||void 0===a?void 0:a.PptInitParams.ClientDiagnostics,s.Va(e)},this.Va=function(e){var t;if(window.performance&&window.performance.getEntriesByType){var i=null===(t=window.performance.getEntriesByType("navigation")[0])||void 0===t?void 0:t.toJSON();i&&i.name&&(delete i.name,e.HostPerfNavigationTelemetry=i)}},this.Ja=function(e,t,i){s.Oa&&(s.Oa.wopiInfo=e),t===ot.UnifiedCreateNew&&function(e){if(e&&e.NewFilePath)window.history.replaceState(null,"",e.NewFilePath),e.UpdatedPageTitle&&(window.document.title=e.UpdatedPageTitle);else if(window.location.href.indexOf("action=editnew")>=0){var t=window.location.href.replace("action=editnew","action=edit");window.history.replaceState(null,window.document.title||"",t)}}(i),window.setTimeout(s.Da,1)},this.Ma=function(){window.removeEventListener("beforeunload",s.qo,{capture:!0}),window.removeEventListener("pagehide",s.Ko,{capture:!0}),window.removeEventListener("visibilitychange",s.Zo,{capture:!0})},this.Ga=function(){var e=je(s.Jt);s.Ss?s.Ss.sendPostMessage(s.Wa,ne.Ti,{isTopFrameTrusted:e}):s.Jt.ULS.Ge(51237655,A.H,U.Error,"Trust frame request received but the wac frame is null")};var a,u=void 0;Promise&&(this.ja=new Promise((function(e){return s.za=e})));try{var l=void 0,f=!1;e.WopiPrecheckInfo&&e.WopiPrecheckInfo.PreseededWacSessionId?(a=e.WopiPrecheckInfo.PreseededWacSessionId,f=!0):i?a=i:(a=(r=ue())[0],l=r[1]),W(Fi(e.ApplicationUrl,a),"PowerPoint","init"),function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),function(e){!e.WopiPrecheckInfo.PreseededSessionKey||"_._._."===e.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)&&"-.-.-."===e.WopiPrecheckInfo.PreseededSessionKey.slice(-6)||(e.WopiPrecheckInfo.PreseededSessionKey="_._._."+e.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.")}(e),e.ApplicationUrl=c(e.ApplicationUrl,h(e.ApplicationUrl,"region")),e.ApplicationUrl=w(e.ApplicationUrl,"region");var p=function(e){if(e){var t=$t(e);return t?t.PodsUrl:e.substring(0,e.toLowerCase().indexOf("powerpointframe.aspx")).replace("/p/","/pods/")}return""}(e.ApplicationUrl);u=t||V({remoteUlsEndpoint:p+"RemoteUls.ashx",sessionId:a}),this.Jt=u;var v=mi(e.SessionInformation.HostSessionId),m=j(j({},e),{SessionId:a,PostMessageToken:v,OnDemandServer:p,FeatureManager:n||Q(e.FnIsFeatureEnabled,u),SettingsManager:o||new ae("PowerPoint",u),UsePodsDetails:en(e,u),ClientDiagnostics:Ae()});o||(m.SettingsManager.addSettingsChangeListener(u.settingsChangeHandler),m.SettingsManager.initializePeriodicFetch(p,a)),new Ni(m,u),u.ULS.Ge(38580693,A.H,U.Warning,"PPTBootstrapper - initializing session. Build version: ".concat(R(),"; UserSessionId: ").concat(a,"; IsSessionIdPreseeded: ").concat(f,"; IsSessionIdToUseProvided: ").concat(!!i)),u.ULS.Ge(38580694,A.H,U.Info,"Bootstrapper Init Time: ".concat((new Date).getTime())),l&&u.ULS.Ge(572618978,A.H,U.Info,JSON.stringify(l)),window.addEventListener("unload",(function(){u.ULS.Ge(41157219,A.H,U.Warning,"Unloading bootstrapper window."),u.ULS.flushOnClose()})),this.qo=function(){return Ii(u,"OnBeforeUnload",!0)},this.Ko=function(){return Ii(u,"OnPageHide",!0)},this.Zo=function(){return Ii(u,"VisibilityChange_"+document.visibilityState,!0)},window.addEventListener("beforeunload",this.qo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Ko,{capture:!0}),window.addEventListener("visibilitychange",this.Zo,{capture:!0}),u.ULS.Ge(38580695,A.H,U.Info,"Application.InitializeWopiPending"),function(e,t){var i={BootstrapperType:"TypeScript",JsApiVersion:"v1",Preview:!1,Scenario:"Unified App",ApplicationUrl:C(e.ApplicationUrl)||null,IsDeepLink:!!I("nav"),BootstrapperInstanceId:le(),IsMobileView:be()};i.ApplicationCustomSettings={OnDemandServer:C(e.OnDemandServer)||null,EnableWacFallback:!0};var n=e.SessionInformation,o=e.Diagnostics,r=o&&o.userClickTime?o.userClickTime:n.DocumentClickTime?n.DocumentClickTime.getTime():null;i.SessionInformation={HostName:n.HostName,HostSessionId:n.HostSessionId,UiLocale:n.UiLocale,DataLocale:n.DataLocale,DocumentClickTime:r,HostInitTime:n.HostInitTime,CurrentTime:D(),UiHost:gi(n.HostName),WdParams:n.WdParams},i.Diagnostics={EntryPoint:hi(e),FileHost:Si(e.SessionInformation.HostName),PodsRing:"",UnifiedUiHostDiagnostics:o?o.unifiedUiHostDiagnostics:null};var s=e.WopiPrecheckInfo,a=!!s.FileGetUrl,c=!!s.CustomFontCatalogUrl;i.WopiPrecheckInfo={FileSize:s.FileSize,FileGetUrlBool:a,CustomFontCatalogBool:c,FileGetUrlLength:a?s.FileGetUrl.length:null,FileNameBool:!!s.FileName,ReadOnly:s.ReadOnly,IrmEnabled:s.IrmEnabled,SupportsDecryptedContentDownload:s.SupportsDecryptedContentDownload,ViewOnly:s.ViewOnly,PreseededSessionKey:!!s.PreseededSessionKey,FileExtension:Z(s.FileName)||null,BundleInfo:s.BundleInfo?{MajorVersion:s.BundleInfo.MajorVersion,URLBool:!!s.BundleInfo.Url}:{}},i.AppInfo={AppVersionMajor:1,AppVersionMinor:20240421007,Environment:"wac",UserAgent:window.navigator.userAgent},i.AdditionalTelemetry={PostMessageToken:e.PostMessageToken},t.ULS.Ge(22357763,A.H,U.Info,JSON.stringify(i,$))}(m,u);var S=m.UsePodsDetails;!function(e,t,i){var n={ShouldUsePodsOrCached:e.ShouldUsePODS,ShouldUsePods:e.ShouldUsePODS,CanUsePods:e.CanUsePODS,ApplicationUrl:C(t)||null,Reason:e.Reason,CreateNewScenario:ot[e.CreateNewScenario]};i.ULS.Ge(38580687,A.H,U.Info,JSON.stringify(n))}(S,m.ApplicationUrl,u);var _=S.ShouldUsePODS;if(_){m.Diagnostics&&m.Diagnostics.userClickTime&&Oe(m.Diagnostics.userClickTime,u),m.IsFileNew=S.CreateNewScenario!==ot.NotCreateNew,m.WopiPrecheckInfo.ReadOnly=m.WopiPrecheckInfo.ReadOnly||!1;var T=Ei(m,u);if(!T){var y={Message:"Error creating IFrame",HostSessionId:m.SessionInformation.HostSessionId};throw u.ULS.Ge(38580696,A.H,U.Error,JSON.stringify(y)),Error("Error Creating IFrame")}u.ULS.Ge(50376725,A.H,U.Warning,"Assigning wopiBootParams"),this.Wa=T.IFrameElement,this.za&&this.za(this.Wa),this.Oa&&(this.Oa.iframe=T.IFrameElement,this.Oa.podsUrl=ti(m.OnDemandServer),this.Oa.readonly=m.WopiPrecheckInfo.ReadOnly,this.Oa.irmEnabled=m.WopiPrecheckInfo.IrmEnabled,this.Oa.supportsDecryptedContentDownload=m.WopiPrecheckInfo.SupportsDecryptedContentDownload,this.Oa.fileName=m.WopiPrecheckInfo.FileName),this.Ss=new sn(d(m.ApplicationUrl),u),this.Ss.activate(T.IFrameElement),m.SessionInformation.SupportsFrameTrustCheck||this.Ss.registerMessagePayloadHandler(ie.Ti,this.Ga),this.Ba=m.SessionInformation.SessionContext?m.SessionInformation.SessionContext:"",this.Ha="",m.SessionInformation.WdParams&&(this.Ha=_i(m.SessionInformation.WdParams)),this.Ha&&u.ULS.Ge(539837381,A.H,U.Warning,"Non-empty WdParams Assigned");var P=j(j({},m.Diagnostics),{hostName:m.SessionInformation.HostName});P.officeFrameCreateTime=T.FrameCreateTime,P.cacheHit=!1,this.Ra={AppInitDiagnostics:P,PptInitParams:m};var E=Qi.getInstance();E&&E.add(v,this)}u.ULS.Ge(50376727,A.H,U.Warning,"Creating WopiPendingApplication"),this.qa={Complete:function(e,t){_?s.Ja(e,S.CreateNewScenario,t):function(e,t,i,n,o){i.ULS.Ge(38147724,A.H,U.Info,"Launching Wac Fallback");var r=document.createElement("iframe");r.id="WebApplicationFrame",r.name="wac_frame",r.title="Office Online Frame",r.frameBorder="0",r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.height="100%",r.style.width="100%",r.style.minHeight="200px",r.style.minWidth="300px",r.style.position="absolute",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),r.style.minHeight="150px";var s=t.Container;s.style.top="0",s.style.bottom="0",s.style.left="0",s.style.right="0",s.style.height="100%",s.style.width="100%",s.style.minHeight="150px";var a=document.createElement("div");a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight="150px",a.style.backgroundColor="#393a3d",a.style.backfaceVisibility="hidden";var c=document.createElement("form");c.name="wac_form",c.id="wac_form",c.target="wac_frame",c.action=function(e,t){if(e.WopiSrc.indexOf("PowerPointFrame.aspx")>=0){var i=e.WopiSrc.substr(e.WopiSrc.indexOf("WOPISrc=")+8),n=i.indexOf("&");e.WopiSrc=n<0?decodeURIComponent(decodeURI(i)):decodeURIComponent(i.substring(0,n))}var o=t.ApplicationUrl,r=o.indexOf("?"),s=o.substring(0,r);return s=Qt(s+="?wdEnableRoaming=1&wdo=1","PowerPointView",h(o,"PowerPointView")),g(o,"new")&&(s=Qt(s,"New","1")),g(o,"embed")&&(s=Qt(s,"Embed","1")),t.OnDemandServer||(s=Qt(s,"noLog","True")),e.WopiSrc&&(s=Qt(s,"WOPISrc",b(e.WopiSrc))),ei(s)}(e,t),c.method="post",c.appendChild(Pi("access_token",e.AccessToken)),c.appendChild(Pi("access_token_ttl",e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0")),e.WacToken&&c.appendChild(Pi("wac_token",e.WacToken)),s.appendChild(c),s.appendChild(a),a.appendChild(r),c.submit();var d={};n.stop();var u=n.getVisibilityChangeEvents();u&&u.length>0&&(d.documentLoadedWithTabSwitch=!0,i.ULS.Ge(38147725,A.H,U.Info,"Visibility Change Events:"+JSON.stringify(u))),t.FnOnInitializeSuccess(new Ui(o),d)}(e,m,u,s.ka,v)},Fail:function(e){s.Jt.ULS.Ge(38293905,A.H,U.Info,"Host failed to give us WopiInfo")},Dispose:function(e,t){s.Na(),t&&t()},PostWacToken:function(e,t,i){s.Ss?function(e,t,i,n,o,r){var s=D();n.ULS.Ge(507774684,A.H,U.Important,"postWacToken flow initiated");var a=function(){r&&r.flush&&r.flush()};o?o.then((function(o){var c=function(){return i.sendPostMessage(o,ne.Jo,{wacToken:e,postWacTokenStart:t})};c();var d=window.setInterval(c,100);i.registerMessagePayloadHandler(ie.Jn,(function(e){n.ULS.Ge(507597019,A.H,U.Info,"postWacToken flow completed in ".concat(D()-s," ms")),window.clearInterval(d),window.clearTimeout(u),r&&(r.PostWacTokenResult="success",r.PostWacTokenEndTime=D(),e&&void 0!==e.TokenAlreadySet&&(r.TokenAlreadySet=e.TokenAlreadySet),a())}));var u=window.setTimeout((function(){n.ULS.Ge(507597018,A.H,U.Warning,"postWacToken flow timed out after ".concat(6e4," ms")),window.clearInterval(d),r&&(r.PostWacTokenResult="timeout",r.PostWacTokenEndTime=D(),a())}),6e4)})).catch((function(e){n.ULS.Ge(507873094,A.H,U.Warning,"This should never reject, error: ".concat(X(e))),r&&(r.PostWacTokenResult="Unexpected JSAPI V1 error",r.PostWacTokenEndTime=D(),a())})):(n.ULS.Ge(507846862,A.H,U.Warning,"`Promise` does not exist natively for this browser."),r&&(r.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",r.PostWacTokenEndTime=D(),a()))}(e,t,s.Ss,s.Jt,s.ja,i):s.Jt.ULS.Ge(507846861,A.H,U.Info,"PPTUnifiedBootstrapper::PostWacToken, this._postMessageHandler is undefined")}},wi(m.BootstrapperUrl,u),window.setTimeout((function(){u&&u.ULS.flush()}),1e4)}catch(t){u&&(u.ULS.Ge(38580697,A.H,U.Error,Ai.AppInitError+": "+X(t)),u.ULS.flushOnClose()),e&&(e.ApplicationUrl&&W(Fi(e.ApplicationUrl,a),"PowerPoint","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Ai.AppInitError,errorObject:t}))}}return e.prototype.log=function(e){this.Jt.ULS.Ge(39978262,A.H,U.Info,e)},e.prototype.onMessage=function(e,t){try{if(!e||!this.Ra)return void this.Jt.ULS.Ge(39978263,A.H,U.Error,"Missing message data: "+!e+" or appData: "+!this.Ra);switch(this.Wa&&this.Wa.contentWindow===t||this.Jt.ULS.Ge(39978264,A.H,U.Error,"Message with the right postMessageToken came from an unexpected iframe"),!e.Data.officeSessionId&&this.Ra.AppInitDiagnostics.officeSessionId&&(e.Data.officeSessionId=this.Ra.AppInitDiagnostics.officeSessionId),e.Data.messageType||(e.Data.messageType=e.Type),this.Jt.ULS.Ge(38580691,A.H,U.Warning,JSON.stringify(e.Data)),e.Type){case Ki.AppPageLoading:break;case Ki.AppReadyForPostMessage:this.Oa&&(this.Oa.hasAppBooted=!0),e.Data.officeSessionId&&(this.Ra.AppInitDiagnostics.officeSessionId=e.Data.officeSessionId),window.setTimeout(this.Da,1);break;case Ki.AppBootComplete:if(this.Fa=!0,this.Ra.PptInitParams.FnOnInitializeSuccess){this.Ra.AppInitDiagnostics.officeBootstrapperVersion=R(),e.Data.officeAppEndpoint&&(this.Ra.AppInitDiagnostics.officeAppEndpoint=e.Data.officeAppEndpoint),e.Data.officeServerVersion&&(this.Ra.AppInitDiagnostics.officeServerVersion=e.Data.officeServerVersion),e.Data.documentLoadedTime&&(this.Ra.AppInitDiagnostics.documentLoadedTime=e.Data.documentLoadedTime,this.Ra.AppInitDiagnostics.appCompletedTime=e.Data.documentLoadedTime),e.Data.officeFrameFirstFlushTime&&(this.Ra.AppInitDiagnostics.officeFrameFirstFlushTime=e.Data.officeFrameFirstFlushTime),e.Data.officeFrameDocumentFlushTime&&(this.Ra.AppInitDiagnostics.officeFrameDocumentFlushTime=e.Data.officeFrameDocumentFlushTime),e.Data.documentFlushTime&&(this.Ra.AppInitDiagnostics.officeFrameServerDocumentFlushTime=e.Data.documentFlushTime),e.Data.serverFirstFlushTime&&(this.Ra.AppInitDiagnostics.officeFrameServerFirstFlushTime=e.Data.serverFirstFlushTime),e.Data.serverStartTime&&(this.Ra.AppInitDiagnostics.officeFrameServerStartTime=e.Data.serverStartTime),e.Data.bootStartMs&&(this.Ra.AppInitDiagnostics.officeServerDocumentProcessStartTime=e.Data.bootStartMs),e.Data.bootEndMs&&(this.Ra.AppInitDiagnostics.officeServerDocumentProcessEndTime=e.Data.bootEndMs),e.Data.cacheHit&&(this.Ra.AppInitDiagnostics.cacheHit=e.Data.cacheHit);var i={browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest"};e.Data.downloadCorrelation&&(i.correlationId=e.Data.downloadCorrelation),e.Data.downloadStartMs&&(i.startTime=e.Data.downloadStartMs),e.Data.downloadEndMs&&(i.endTime=e.Data.downloadEndMs),e.Data.downloadSize&&(i.size=e.Data.downloadSize),e.Data.incDownload&&(i.incremental=e.Data.incDownload),this.Ra.AppInitDiagnostics.fileRequestsData=[i],this.ka.stop();var n=this.ka.getVisibilityChangeEvents();if(n&&n.length>0&&(this.Ra.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,this.Jt.ULS.Ge(38580692,A.H,U.Info,"Visibility Change Events:"+JSON.stringify(n))),this.Jt.ULS.Ge(34932955,A.H,U.Warning,JSON.stringify(this.Ra.AppInitDiagnostics)),!this.Ss)throw this.Jt.ULS.Ge(51448022,A.H,U.Warning,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),Error("m_postMessageHandler");this.Ka=new ln(this.Ra.PptInitParams.PostMessageToken,this.Jt,this.Ss,this.Na,{innerApplicationFrame:this.Wa}),this.Ra.PptInitParams.FnOnInitializeSuccess(this.Ka,this.Ra.AppInitDiagnostics),this.Ss.da()}break;case Ki.RefreshPage:if(this.Ra.PptInitParams.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&this.Ra.PptInitParams.SessionInformation.SupportsDocReboot)break;var o=window.location.href;-1!==o.indexOf("&wdccsoff=1")&&(o=w(o,"wdccsoff")),e.Data.officeSessionId&&(o=Qt(o,"PreviousSessionID",e.Data.officeSessionId)),e.Data.ControllerServicesParam&&(o=Qt(o,e.Data.ControllerServicesParamName,e.Data.ControllerServicesParam)),this.Jt.ULS.Ge(594068673,A.H,U.Info,"PPTUnifiedSessionLoader::onMessage::RefreshPage Updating window.location.href"),window.location.href=o;break;case Ki.UpdateInitializationComplete:try{if("FatalError"===e.Data.Reason){var r={ErrorName:e.Data.ErrorName,BootCompleted:this.Fa,SessionInfo:(a=this.Ra.PptInitParams,c=a.SessionInformation,u=a.Diagnostics,{HostName:c.HostName,HostSessionId:c.HostSessionId,UiLocale:c.UiLocale,DataLocale:c.DataLocale,DocumentClickTime:u&&u.userClickTime?u.userClickTime:c.DocumentClickTime?c.DocumentClickTime.getTime():void 0,HostInitTime:c.HostInitTime,UiHost:gi(c.HostName),WdParams:c.WdParams})};this.Jt.ULS.Ge(587236555,A.H,U.Error,JSON.stringify(r))}else this.Jt.ULS.Ge(576583120,A.H,U.Info,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete - Reason: ".concat(e.Data.Reason))}catch(e){this.Jt.ULS.Ge(576582732,A.H,U.Error,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete Caught exception: "+e)}this.Ss||(this.Jt.ULS.Ge(51448024,A.H,U.Info,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),this.Ss=new sn(d(this.Ra.PptInitParams.ApplicationUrl),this.Jt),this.Ss.activate(this.Wa)),this.Ka=new ln(this.Ra.PptInitParams.PostMessageToken,this.Jt,this.Ss,this.Na,{innerApplicationFrame:this.Wa}),this.Ra.PptInitParams.FnOnInitializeSuccess(this.Ka,this.Ra.AppInitDiagnostics),this.Ss.da();break;case Ki.ProfileClientResourceUsage:this.Jt.ULS.Ge(541388952,A.H,U.Info,JSON.stringify(e.Data));break;case Ki.ULSLog:var s=e.Data;if(!s||"number"!=typeof s.Tag||"number"!=typeof s.Category||"number"!=typeof s.Level||"string"!=typeof s.Message)break;try{this.Jt.ULS.Ge(s.Tag,s.Category,s.Level,s.Message)}catch(e){this.Jt.ULS.Ge(512235073,A.H,U.Error,"PPTUnifiedSessionLoader::onMessage ULSLog exception: "+e)}}}catch(e){this.Jt.ULS.Ge(594121922,A.H,U.Error,"PPTUnifiedSessionLoader::onMessage Caught exception: "+e)}var a,c,u},e.prototype.getWopiPendingApplication=function(){return this.qa},e}(),hn=function(){function e(){}return e.prototype.GetVersion=function(){return R()},e.prototype.GetMinContentVersion=function(){return 1},e.prototype.Prefetch=function(){},e.prototype.InitializeWopiPending=function(e,t,i,n,o,r){return new pn(e,t,i,o,r).getWopiPendingApplication()},e}();!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(un||(un={}));var vn=new hn,wn=function(e){var t={name:"PowerPoint",usePreseededSessionId:!0,preconnector:y()};return new Ke(e,t,Xi)}}});
//# sourceMappingURL=powerpoint.app.boot.4c11c25adc0b4ee4ce0d.js.map